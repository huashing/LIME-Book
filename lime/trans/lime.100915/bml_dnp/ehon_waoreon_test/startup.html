<?xml version="1.0" encoding="EUC-JP" ?><!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//JA'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html><head><meta content="IE=8" http-equiv="X-UA-Compatible"/><style>body 
{
	z-index				:auto;
	display				:block;
	visibility			:visible;
	background-image		:none;
	background-repeat		:repeat;

	margin				:0px;
	padding				:0px;
	border-width			:0px;
	position			:absolute;

	background-color		:#000000;
	width				:960px;
	height				:540px;

}

div 
{
	position			:absolute;
	margin				:0px;
	padding				:0px;
	border-width			:0px;
	border-style			:none;
	border-color			:#000000;

	left				:0px;
	top				:0px;
	width				:0px;
	height				:0px;
	z-index				:auto;
	display				:block;
	visibility			:inherit;
	overflow			:hidden;
	font-size			:100%;
	white-space			:normal;
	

}

p
{
	position			:absolute;
	margin				:0px;
	padding				:0px;
	border-width			:0px;
	border-style			:none;
	border-color			:#000000;

	left				:0px;
	top				:0px;
	width				:0px;
	height				:0px;
	z-index				:auto;
	display				:block;
	visibility			:inherit;
	overflow			:hidden;

	line-height			:normal;
	font-family			:'ARISAKA-ðÈ¾£','IPA¥´¥·¥Ã¥¯';
	font-size			:24px;
	font-weight			:normal;
	text-align			:left;
	letter-spacing			:normal;
	white-space			:normal;
	line-height			:100%;
	word-break			:break-all;
	
	word-wrap			:break-word;
	
}

input
{
	position			:absolute;
	margin				:0px;
	padding				:0px;
	border-width			:0px;
	border-style			:none;
	border-color			:#000000;

	left				:0px;
	top				:0px;
	width				:0px;
	height				:0px;
	z-index				:auto;
	display				:block;
	visibility			:inherit;
	overflow			:hidden;

	line-height			:normal;
	font-family			:'ARISAKA-ðÈ¾£','IPA¥´¥·¥Ã¥¯';
	font-size			:24px;
	font-weight			:normal;
	text-align			:left;
	letter-spacing			:normal;
	white-space			:normal;
	line-height			:100%;
	
	
}

span
{
	border-width			:0px;
	border-style			:none;
	border-color			:#000000;

	position			:static;
	z-index				:auto;
	line-height			:inherit;
	display				:inline;
	visibility			:inherit;
	font-family			:'ARISAKA-ðÈ¾£','IPA¥´¥·¥Ã¥¯';
	font-size			:24px;
	font-weight			:normal;
	letter-spacing			:inherit;
	font-size			:100%;
	line-height			:100%;

	
}

a
{
	border-width			:0px;
	border-style			:none;
	border-color			:#000000;

	position			:static;
	z-index				:auto;
	line-height			:inherit;
	display				:inline;
	visibility			:inherit;
	font-family			:'ARISAKA-ðÈ¾£','IPA¥´¥·¥Ã¥¯';
	font-size			:24px;
	font-weight			:normal;
	letter-spacing			:inherit;
	font-size			:100%;
	white-space			:normal;
	line-height			:100%;
	color				:#000000;
	text-decoration		:none;
}




br
{
	position			:static;
	z-index				:auto;
	line-height			:inherit;
	display				:inline;
	line-height			:100%;
}

object
{
	position			:absolute;
	margin				:0px;
	padding				:0px;
	border-width			:0px;
	border-style			:none;
	border-color			:#000000;

	left				:0px;
	top				:0px;
	width				:0px;
	height				:0px;
	z-index				:auto;
	display				:block;
	visibility			:inherit;
	overflow			:hidden;

	
}

img
{
	position			:absolute;
	margin				:0px;
	padding				:0px;
	border-width			:0px;
	border-style			:none;
	border-color			:#000000;

	left				:0px;
	top				:0px;
	width				:0px;
	height				:0px;
	z-index				:auto;
	display				:block;
	visibility			:inherit;
	overflow			:hidden;

	
}</style><title></title>
<style media="all" type="text/css">
/* STYLE */
	.gazo
{
width:812px; top:23px; left:75px; visibility:hidden; height:440px; 
}
</style>

</head>
<body onLoad="BML.Navigation.initialize();load();;" style="clut:url(bg_clt.clt); behavior:url(#default#download);">
<div style="width:960px; height:540px; ">
	<img src="bg01.jpg" style="width:960px; height:540px; "/>
	
	<div id="bl1" style="width:0px; top:469px; left:148px; height:63px; ">
		<div style="width:157px; height:63px; ">
			<img id="bl1n" src="bt01_n.jpg" style="width:157px; height:63px; "/>
			<img id="bl1d" src="bt01_d.jpg" style="width:157px; visibility:hidden; height:63px; "/>
		</div>
	</div>
	<div id="rd1" style="width:0px; top:469px; left:305px; height:63px; ">
		<div style="width:159px; height:63px; ">
			<img id="rd1n" src="bt02_n.jpg" style="width:159px; height:63px; "/>
			<img id="rd1d" src="bt02_d.jpg" style="width:159px; visibility:hidden; height:63px; "/>
		</div>
	</div>
	<div id="gr1" style="width:0px; top:469px; left:464px; height:63px; ">
		<div style="width:180px; height:63px; ">
			<img id="gr1n" src="bt03_n.jpg" style="width:180px; height:63px; "/>
			<img id="gr1d" src="bt03_d.jpg" style="width:180px; visibility:hidden; height:63px; "/>
		</div>
	</div>
	<div id="yl1" style="width:0px; top:469px; left:644px; height:63px; ">
		<div style="width:170px; height:63px; ">
			<img id="yl1n" src="bt13_n.jpg" style="width:170px; height:63px; "/>
			<img id="yl1d" src="bt13_d.jpg" style="width:170px; visibility:hidden; height:63px; "/>
		</div>
	</div>
	
	<div id="bl2" style="width:0px; top:469px; left:148px; height:63px; ">
		<div style="width:157px; height:63px; ">
			<img id="bl2n" src="bt05_n.jpg" style="width:157px; height:63px; "/>
			<img id="bl2d" src="bt05_d.jpg" style="width:157px; visibility:hidden; height:63px; "/>
		</div>
	</div>
	<div id="rd2" style="width:0px; top:469px; left:305px; height:63px; ">
		<div style="width:159px; height:63px; ">
			<img id="rd2n" src="bt06_n.jpg" style="width:159px; height:63px; "/>
			<img id="rd2d" src="bt06_d.jpg" style="width:159px; visibility:hidden; height:63px; "/>
		</div>
	</div>
	<div id="gr2" style="width:0px; top:469px; left:464px; height:63px; ">
		<div style="width:180px; height:63px; ">
			<img id="gr2n" src="bt07_n.jpg" style="width:180px; height:63px; "/>
			<img id="gr2d" src="bt07_d.jpg" style="width:180px; visibility:hidden; height:63px; "/>
		</div>
	</div>
	<div id="yl2" style="width:0px; top:469px; left:644px; height:63px; ">
		<div style="width:170px; height:63px; ">
			<img id="yl2n" src="bt08_n.jpg" style="width:170px; height:63px; "/>
			<img id="yl2d" src="bt08_d.jpg" style="width:170px; visibility:hidden; height:63px; "/>
		</div>
	</div>
	
	<div id="bl3" style="width:0px; top:469px; left:148px; height:63px; ">
		<div style="width:157px; height:63px; ">
			<img id="bl3n" src="bt10_n.jpg" style="width:157px; height:63px; "/>
			<img id="bl3d" src="bt10_d.jpg" style="width:157px; visibility:hidden; height:63px; "/>
		</div>
	</div>
	<div id="rd3" style="width:0px; top:469px; left:305px; height:63px; ">
		<div style="width:159px; height:63px; ">
			<img id="rd3n" src="bt11_n.jpg" style="width:159px; height:63px; "/>
			<img id="rd3d" src="bt11_d.jpg" style="width:159px; visibility:hidden; height:63px; "/>
		</div>
	</div>
	<div id="gr3" style="width:0px; top:469px; left:464px; height:63px; ">
		<div style="width:180px; height:63px; ">
			<img id="gr3n" src="bt12_n.jpg" style="width:180px; height:63px; "/>
			<img id="gr3d" src="bt12_d.jpg" style="width:180px; visibility:hidden; height:63px; "/>
		</div>
	</div>
	<div id="yl3" style="width:0px; top:469px; left:644px; height:63px; ">
		<div style="width:170px; height:63px; ">
			<img id="yl3n" src="bt08_n.jpg" style="width:170px; height:63px; "/>
			<img id="yl3d" src="bt08_d.jpg" style="width:170px; visibility:hidden; height:63px; "/>
		</div>
	</div>
</div>
<div _onKeyDown="keyDown();" _onKeyUp="keyUp();" id="btn" nav_index="0"></div>
<div>
	<object classid="CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95" id="bgm"><param name="FileName" value="ehon.aac"/><param name="AutoRewind" value="False"/><param name="ShowControls" value="False"/><param name="autostart" value="false"/></object>
</div>

<div id="p21" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p21d" style="width:812px; height:440px; ">
		<img src="21.jpg" style="width:812px; height:440px; "/>
	</div>
</div>
<div id="p20" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p20d" style="width:812px; height:440px; ">
		<img src="20.jpg" style="width:812px; height:440px; "/>
		<div id="p20_1" style="width:0px; top:176px; left:59px; height:46px; ">
			<div style="width:334px; height:46px; ">
				<img src="20_01.jpg" style="width:334px; height:46px; "/>
			</div>
		</div>
		<div id="p20_2" style="width:0px; top:222px; left:59px; height:46px; ">
			<div style="width:334px; height:46px; ">
				<img src="20_02.jpg" style="width:334px; height:46px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p19" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p19d" style="width:812px; height:440px; ">
		<img src="19.jpg" style="width:812px; height:440px; "/>
		<div id="p19_1" style="width:0px; top:172px; left:239px; height:32px; ">
			<div style="width:334px; height:32px; ">
				<img src="19_01.jpg" style="width:334px; height:32px; "/>
			</div>
		</div>
		<div id="p19w_1" style="width:0px; top:172px; left:239px; height:32px; ">
			<div style="width:334px; height:32px; ">
				<img src="19_01w.jpg" style="width:334px; height:32px; "/>
			</div>
		</div>
		<div id="p19_2" style="width:0px; top:204px; left:239px; height:32px; ">
			<div style="width:334px; height:32px; ">
				<img src="19_02.jpg" style="width:334px; height:32px; "/>
			</div>
		</div>
		<div id="p19r_2" style="width:0px; top:204px; left:239px; height:32px; ">
			<div style="width:334px; height:32px; ">
				<img src="19_02r.jpg" style="width:334px; height:32px; "/>
			</div>
		</div>
		<div id="p19_3" style="width:0px; top:236px; left:239px; height:32px; ">
			<div style="width:334px; height:32px; ">
				<img src="19_03.jpg" style="width:334px; height:32px; "/>
			</div>
		</div>
		<div id="p19w_3" style="width:0px; top:236px; left:239px; height:32px; ">
			<div style="width:334px; height:32px; ">
				<img src="19_03w.jpg" style="width:334px; height:32px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p18" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p18d" style="width:812px; height:440px; ">
		<img src="18.jpg" style="width:812px; height:440px; "/>
		<div id="p18_1" style="width:0px; top:295px; left:473px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="18_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p18w_1" style="width:0px; top:295px; left:473px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="18_01w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p18_2" style="width:0px; top:321px; left:473px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="18_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p18w_2" style="width:0px; top:321px; left:473px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="18_02w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p18_3" style="width:0px; top:347px; left:473px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="18_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p18w_3" style="width:0px; top:347px; left:473px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="18_03w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p18_4" style="width:0px; top:373px; left:473px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="18_04.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p18r_4" style="width:0px; top:373px; left:473px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="18_04r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p17" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p17d" style="width:812px; height:440px; ">
		<img src="17.jpg" style="width:812px; height:440px; "/>
		<div id="p17_1" style="width:0px; top:102px; left:478px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="17_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p17w_1" style="width:0px; top:102px; left:478px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="17_01w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p17_2" style="width:0px; top:128px; left:478px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="17_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p17w_2" style="width:0px; top:128px; left:478px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="17_02w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p16" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p16d" style="width:812px; height:440px; ">
		<img src="16.jpg" style="width:812px; height:440px; "/>
		<div id="p16_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="16_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p16_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="16_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p16_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="16_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p16_4" style="width:0px; top:113px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="16_04.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p15" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p15d" style="width:812px; height:440px; ">
		<img src="15.jpg" style="width:812px; height:440px; "/>
		<div id="p15_1" style="width:0px; top:276px; left:254px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="15_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p15_2" style="width:0px; top:302px; left:254px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="15_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p15_3" style="width:0px; top:328px; left:254px; height:19px; ">
			<div style="width:334px; height:19px; ">
				<img src="15_03.jpg" style="width:334px; height:19px; "/>
			</div>
		</div>
		<div id="p15_4" style="width:0px; top:347px; left:169px; height:56px; ">
			<div style="width:334px; height:56px; ">
				<img src="15_04.jpg" style="width:334px; height:56px; "/>
			</div>
		</div>
		<div id="p15r_4" style="width:0px; top:347px; left:169px; height:56px; ">
			<div style="width:334px; height:56px; ">
				<img src="15_04r.jpg" style="width:334px; height:56px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p14" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p14d" style="width:812px; height:440px; ">
		<img src="14.jpg" style="width:812px; height:440px; "/>
		<div id="p14_1" style="width:0px; top:24px; left:39px; height:42px; ">
			<div style="width:334px; height:42px; ">
				<img src="14_01.jpg" style="width:334px; height:42px; "/>
			</div>
		</div>
		<div id="p14w_1" style="width:0px; top:24px; left:39px; height:42px; ">
			<div style="width:334px; height:42px; ">
				<img src="14_01w.jpg" style="width:334px; height:42px; "/>
			</div>
		</div>
		<div id="p14_2" style="width:0px; top:66px; left:39px; height:61px; ">
			<div style="width:334px; height:61px; ">
				<img src="14_02.jpg" style="width:334px; height:61px; "/>
			</div>
		</div>
		<div id="p14w_2" style="width:0px; top:66px; left:39px; height:61px; ">
			<div style="width:334px; height:61px; ">
				<img src="14_02w.jpg" style="width:334px; height:61px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p13" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p13d" style="width:812px; height:440px; ">
		<img src="13.jpg" style="width:812px; height:440px; "/>
		<div id="p13_1" style="width:0px; top:136px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="13_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p13r_1" style="width:0px; top:136px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="13_01r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p13_2" style="width:0px; top:188px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="13_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p13w_2" style="width:0px; top:188px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="13_02w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p12" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p12d" style="width:812px; height:440px; ">
		<img src="12.jpg" style="width:812px; height:440px; "/>
		<div id="p12_1" style="width:0px; top:65px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12_2" style="width:0px; top:91px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12_3" style="width:0px; top:117px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12r_3" style="width:0px; top:117px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_03r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12_4" style="width:0px; top:143px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_04.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12r_4" style="width:0px; top:143px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_04r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12_5" style="width:0px; top:195px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_05.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12_6" style="width:0px; top:221px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_06.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12w_6" style="width:0px; top:221px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_06w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12_7" style="width:0px; top:247px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_07.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12w_7" style="width:0px; top:247px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_07w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12_8" style="width:0px; top:273px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_08.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p12w_8" style="width:0px; top:273px; left:24px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="12_08w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p11" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p11d" style="width:812px; height:440px; ">
		<img src="11.jpg" style="width:812px; height:440px; "/>
		<div id="p11_1" style="width:0px; top:247px; left:478px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="11_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p11_2" style="width:0px; top:273px; left:478px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="11_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p11r_2" style="width:0px; top:273px; left:478px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="11_02r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p11_3" style="width:0px; top:325px; left:478px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="11_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p11_4" style="width:0px; top:351px; left:478px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="11_04.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p11w_4" style="width:0px; top:351px; left:478px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="11_04w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p11_5" style="width:0px; top:377px; left:478px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="11_05.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p10" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p10d" style="width:812px; height:440px; ">
		<img src="10.jpg" style="width:812px; height:440px; "/>
		<div id="p10_1" style="width:0px; top:82px; left:402px; height:86px; ">
			<div style="width:334px; height:86px; ">
				<img src="10_01.jpg" style="width:334px; height:86px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p9" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p9d" style="width:812px; height:440px; ">
		<img src="09.jpg" style="width:812px; height:440px; "/>
		<div id="p9_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="09_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p9w_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="09_01w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p9_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="09_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p9w_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="09_02w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p9_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="09_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p9_4" style="width:0px; top:113px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="09_04.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p9_5" style="width:0px; top:139px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="09_05.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p9r_5" style="width:0px; top:139px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="09_05r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p9_6" style="width:0px; top:165px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="09_06.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p8" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p8d" style="width:812px; height:440px; ">
		<img src="08.jpg" style="width:812px; height:440px; "/>
		<div id="p8_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="08_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p8r_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="08_01r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p8_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="08_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p8r_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="08_02r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p8_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="08_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p8w_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="08_03w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p7" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p7d" style="width:812px; height:440px; ">
		<img src="07.jpg" style="width:812px; height:440px; "/>
		<div id="p7_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="07_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p7w_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="07_01w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p7_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="07_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p7w_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="07_02w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p7_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="07_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p7w_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="07_03w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p7_4" style="width:0px; top:113px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="07_04.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p7r_4" style="width:0px; top:113px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="07_04r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p7_5" style="width:0px; top:139px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="07_05.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p7r_5" style="width:0px; top:139px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="07_05r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p7_6" style="width:0px; top:165px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="07_06.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p6" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p6d" style="width:812px; height:440px; ">
		<img src="06.jpg" style="width:812px; height:440px; "/>
		<div id="p6_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="06_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p6w_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="06_01w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p6_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="06_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p6w_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="06_02w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p6_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="06_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p6w_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="06_03w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p6_4" style="width:0px; top:113px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="06_04.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p6_5" style="width:0px; top:139px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="06_05.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p5" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p5d" style="width:812px; height:440px; ">
		<img src="05.jpg" style="width:812px; height:440px; "/>
		<div id="p5_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="05_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p5w_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="05_01w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p5_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="05_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p5_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="05_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p5_4" style="width:0px; top:113px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="05_04.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p5r_4" style="width:0px; top:113px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="05_04r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p5_5" style="width:0px; top:139px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="05_05.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p5r_5" style="width:0px; top:139px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="05_05r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p5_6" style="width:0px; top:165px; left:39px; height:28px; ">
			<div style="width:334px; height:28px; ">
				<img src="05_06.jpg" style="width:334px; height:28px; "/>
			</div>
		</div>
		<div id="p5r_6" style="width:0px; top:165px; left:39px; height:28px; ">
			<div style="width:334px; height:28px; ">
				<img src="05_06r.jpg" style="width:334px; height:28px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p4" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p4d" style="width:812px; height:440px; ">
		<img src="04.jpg" style="width:812px; height:440px; "/>
		<div id="p4_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="04_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p4_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="04_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p4_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="04_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p3" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p3d" style="width:812px; height:440px; ">
		<img src="03.jpg" style="width:812px; height:440px; "/>
		<div id="p3_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="03_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p3r_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="03_01r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p3_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="03_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p3w_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="03_02w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p3_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="03_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p3_4" style="width:0px; top:113px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="03_04.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p2" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p2d" style="width:812px; height:440px; ">
		<img src="02.jpg" style="width:812px; height:440px; "/>
		<div id="p2_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="02_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p2_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="02_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p2w_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="02_02w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p2_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="02_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p2r_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="02_03r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>
<div id="p1" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p1d" style="width:812px; height:440px; ">
		<img src="01.jpg" style="width:812px; height:440px; "/>
		<div id="p1_1" style="width:0px; top:35px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="01_01.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p1_2" style="width:0px; top:61px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="01_02.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p1_3" style="width:0px; top:87px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="01_03.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p1_4" style="width:0px; top:113px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="01_04.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p1w_4" style="width:0px; top:113px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="01_04w.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p1_5" style="width:0px; top:139px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="01_05.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
		<div id="p1r_5" style="width:0px; top:139px; left:39px; height:26px; ">
			<div style="width:334px; height:26px; ">
				<img src="01_05r.jpg" style="width:334px; height:26px; "/>
			</div>
		</div>
	</div>
</div>

<div id="p0" style="width:0px; top:23px; left:75px; height:440px; ">
	<div id="p0d" style="width:812px; height:440px; ">
		<img src="00.jpg" style="width:378px; left:218px; height:440px; "/>
	</div>
</div>
<p id="debug" style="width:960px; height:540px; white-space:pre;"> </p>
<p id="debug2" style="width:960px; top:30px; height:510px; white-space:pre;"> </p>
<p id="debug3" style="width:960px; top:60px; height:480px; white-space:pre;"> </p>
<p id="debug4" style="width:960px; top:90px; height:450px; white-space:pre;"> </p>
</body>
<script charset="EUC-JP" language="javascript" type="text/javascript">
var BML = (typeof (BML) == 'undefined') ? {} : BML;

BML.Aux = (function(){

	function extend(dst, src) {
	    for (k in src) {
	        if (typeof (src[k]) == 'object') {
	            dst[k] = {};
	            extend(dst[k], src[k]);
	        }
	        else {
	            dst[k] = src[k];
	        }
	    }
	    return (dst);
	}
	
	
	function trim(str) {
	    str = str.replace(/(^\s*)/g, '');
	    return str.replace(/(\s*$)/g, '');
	}
	
	function camelize(str) {
	    var parts = str.split('-');
	    if (parts.length <= 1)
	        return (str);
	
	    var buf = String(parts[0]).toLowerCase();
	    for (var i = 1, l = parts.length; i < l; i++) {
	        var part = String(parts[i]);
	        if (!part) continue;
	        part = part.toLowerCase();
	        buf += part.charAt(0).toUpperCase() + part.substring(1);
	    }
	    return (buf);
	}
	
	function each(iterator, context) {
   		context = context || this;
    		try {
      			for(var i = 0, l = this.length; i < l; i++) {
        			iterator.call(context, this[i], i);
      			}
    		} 
		catch(e) {
    		}
    		return(this);
  	}			
	
	function isUndefined(obj) { 
		return(typeof(obj) == 'undefined'); 
	}

	function getClass(obj) {
    		return(Object.prototype.toString.call(obj).match(/^\[object\s(.*)\]$/)[1]);
	}
	function isArray(obj)      { return(getClass(obj) == 'Array'); }

	function emptyFunction()   { }

	var slice = Array.prototype.slice;

	function append(array) {
   	 	var thisLength = this.length, length = array.length;
   	 	while(length--) this[thisLength + length] = array[length];
    		return(this);
  	}

	function bind(context) {
    		if ((arguments.length < 2) && isUndefined(arguments[0])) return(this);
    
    		var __method = this, args = slice.call(arguments, 1);
    		return(function() {
      			var a = append.call(slice.call(args, 0), arguments);
      			return(__method.apply(context, a));
    		});
  	}
  
  	function wait(timeout, context) {
    		var __method = this, args = slice.call(arguments, 2);
    		return(window.setTimeout(function() {
      			return(__method.apply(context || null, args));
    			}, timeout * 1000));
  	}

	function combinePath(relative, current) {
    		if (relative.indexOf('http') >= 0) return(relative);

    		var path = current;
    		path = path.split('/');
		relative = relative.split('/');
    		var buf = [];
		for( var k = 0, lk = path.length-1; k < lk; k++ ){
			buf.push(path[k]);
		}
    		for(var i = 0, l = relative.length; i < l; i++) {
      			var p = relative[i];
      			((p == '..') && (buf.length > 0)) ? buf.pop() : buf.push(p);
    		}
    		return(buf.join('/'));
  	}
  	
  	function toPaddedString(str, pad, len) {
    	var ret = ''; str = String(str); pad = pad || ' ';
    	for(var i = str.length, l = len || 2; i < l; i++) ret += pad;
    	return(ret + str);
  	}

	return ({	
		extend: 	extend,
		trim: 		trim,
		camelize:	camelize,
		each: 		each,
		isUndefined:	isUndefined,
		emptyFunction:	emptyFunction,
		bind:		bind,
		wait:		wait,
		combinePath:	combinePath,
		toPaddedString:	toPaddedString,
		isArray:	isArray
	});
})();



BML.Processor = (function() {
	
	var ARIB_KEYCODE  = {
	    UP      :  1,    DOWN    :  2,    LEFT    :  3,    RIGHT   :  4,
	    0       :  5,    1       :  6,    2       :  7,    3       :  8,
	    4       :  9,    5       : 10,    6       : 11,    7       : 12,
	    8       : 13,    9       : 14,    10      : 15,    11      : 16,
	    12      : 17,
	    ENTER   : 18,    BACK    : 19,    DBUTTON : 20,
	    B       : 21,    R       : 22,    G       : 23,    Y       : 24
	};
	
	
	function isDirectionKey(keyCode) {
		return keyCode >= ARIB_KEYCODE["UP"] && keyCode <= ARIB_KEYCODE["RIGHT"];
	}
	
	function isAccessKey(keyCode) {
		return keyCode >= ARIB_KEYCODE["B"] && keyCode <= ARIB_KEYCODE["Y"];
	}
	
	function isNumericKey(keyCode) {
		return keyCode >= ARIB_KEYCODE["0"] && keyCode <= ARIB_KEYCODE["12"];
	}
	
	
	
    function processInput(event) {
    	var type = event.type;
    	var code = event.keyCode;
    	BML.Dom.UpdateObjectState();
    	switch(type) {
    		case ("keydown"): {
    			if( code == ARIB_KEYCODE["DBUTTON"] ) {
    				break;
    			}
    			document.currentEvent = {type: "keydown", target: document.currentFocus, keyCode: code};
				
				if( document.currentFocus && document.currentFocus._onKeyDown ) {
					
					eval(document.currentFocus._onKeyDown);
				}
				
    			if( isDirectionKey(code) || isAccessKey(code) ) {
    				BML.Navigation.navigate(code);
    				if( isAccessKey(code) && document.currentFocus && document.currentFocus._onClick ) {
						document.currentEvent = {type:"click", target:document.currentFocus};
    					eval(document.currentFocus._onClick);
    				}
    			}
    			else if( isNumericKey(code) ) {
    			}
    			else if( code == ARIB_KEYCODE["ENTER"] ) {
    				var currentFocus = document.currentFocus;
    				document.currentEvent = {type:"click", target:currentFocus};
    				if( currentFocus && currentFocus._onClick ) {
    					eval(currentFocus._onClick);
    				}
    				
    				if( currentFocus ) {
    					BML.CSS.setElementActiveStyle(currentFocus);
    				}
    				
    				if( document.currentFocus && (nodeName = document.currentFocus.nodeName.toLowerCase()) == "a" ) {
    					if( typeof(document.currentFocus.href) != "undefined" && BML.Aux.trim(document.currentFocus.href) != "") {
    					
    						window.navigate(document.currentFocus.href);
    						var temp = document.currentFocus.href + "?";
						    if( temp.indexOf(".bml?") >=0 ){
						    	temp = temp.replace(".bml?",".html");
						    	window.navigate(temp);
						    }
    					}
    				}
    			}
    			else {
    			}
    			
    			if( document.currentFocus && (nodeName = document.currentFocus.nodeName.toLowerCase()) == "input" ) {			
	    			if( code >= ARIB_KEYCODE["0"] && code <= ARIB_KEYCODE["12"] ){		
	    				document.currentFocus.value = document.currentFocus.value + String(code-ARIB_KEYCODE["0"]);
	    			}
	    			if (code == ARIB_KEYCODE["BACK"]) {
	    			    if (document.currentFocus.value.length>0){
	    				    document.currentFocus.value = document.currentFocus.value.substr(0,document.currentFocus.value.length-1);
	    			    }
	    			}
    			}
    			
    			break;
    		}
    		case ("keyup"): {
    			if( code == ARIB_KEYCODE["DBUTTON"] ) {
    				break;
    			}
    			
				document.currentEvent = {type: "keyup", target: document.currentFocus, keyCode: code};
				if( document.currentFocus && document.currentFocus._onKeyUp ) {
					eval(document.currentFocus._onKeyUp);
				}
				
				if( code == ARIB_KEYCODE["ENTER"] ) {
					if( document.currentFocus ) {
    					BML.CSS.unSetElementActiveStyle(document.currentFocus);
    				}
    			}
    			break;
    		}
    		default:
    			break;
    	}
    	BML.Dom.UpdateObjectState();
    	
    }
	
	
    return ({
        processInput: processInput,
        ARIB_KEYCODE: ARIB_KEYCODE,
        isAccessKey: isAccessKey
    });
})();



BML.Navigation = {};
BML.Aux.extend( BML.Navigation, (function() {

	function getNavigationInfo(element) {
        if (typeof (element.nav_index) != "undefined") {
            BML.Navigation.navIndex2Element[element.nav_index] = element;
        }
        if (typeof (element._accessKey) != "undefined") {
            BML.Navigation.accessKey2Element[BML.Processor.ARIB_KEYCODE[element._accessKey]] = element;
        }
        
        var children = element.childNodes;
        for (var i = 0, l = children.length; i < l; i++) {
            getNavigationInfo(children[i]);
        }
    }

  

    function initialize() {
        BML.Navigation.navIndex2Element = {};
        BML.Navigation.accessKey2Element = {};
        getNavigationInfo(document);
        for( var key in BML.Navigation.navIndex2Element )
        {
        	document.currentFocus = BML.Navigation.navIndex2Element[key];
        	break;
        }
        if( !document.currentFocus )
        {
        	for( var key in BML.Navigation.accessKey2Element )
	        {
	        	document.currentFocus = BML.Navigation.accessKey2Element[key];
	        	break;
	        }
        }
        if( !document.currentFocus )
        {
        	document.currentFocus = document.getElementsByTagName("body")[0].childNodes[0];
        }
        if(document.currentFocus) {
        	document.currentFocus.focus();
        	BML.CSS.setElementFocusStyle(document.currentFocus);
        }
    }

    function navUp() {
        elm = document.currentFocus;
        nextIdx = elm.nav_up;
        nextElm = BML.Navigation.navIndex2Element[nextIdx];
        if( (elm) && (nextElm) ) {
        	navNext(elm, nextElm);
        }
    }

    function navDown() {
        elm = document.currentFocus;
        nextIdx = elm.nav_down;
        nextElm = BML.Navigation.navIndex2Element[nextIdx];
        if( (elm) && (nextElm) ) {
        	navNext(elm, nextElm);
        }
    }

    function navLeft() {
        elm = document.currentFocus;
        nextIdx = elm.nav_left;
        nextElm = BML.Navigation.navIndex2Element[nextIdx];
        if( (elm) && (nextElm) ) {
        	navNext(elm, nextElm);
        }
    }

    function navRight() {
        elm = document.currentFocus;
        nextIdx = elm.nav_right;
        nextElm = BML.Navigation.navIndex2Element[nextIdx];
        if( (elm) && (nextElm) ) {
        	navNext(elm, nextElm);
        }
    }

    function navNext(elm, nextElm) {    
    
    	if( (!elm) || (!nextElm)  )
    		return;
    		
    	
        if( elm._onBlur &&  (elm != nextElm)) {
        	document.currentEvent = {type:"blur", target:elm};
        	currentFocus = document.currentFocus;
        	document.currentFocus = elm;
        	eval(elm._onBlur);
        	document.currentFocus = currentFocus;
        }
        
        BML.CSS.unSetElementFocusStyle(elm);
        document.currentFocus = nextElm;
        BML.CSS.setElementFocusStyle(nextElm);
        
        if( nextElm._onFocus ) {
        	document.currentEvent = {type:"focus", target:nextElm};
        	currentFocus = document.currentFocus;
        	document.currentFocus = nextElm;
        	eval(nextElm._onFocus);
        	document.currentFocus = currentFocus;
        }
    }

	function navigate(keyCode) {
	
		if( BML.Processor.isAccessKey(keyCode)) {
			var elm = document.currentFocus;
			nextElm = BML.Navigation.accessKey2Element[keyCode];
	        if( (elm) && (nextElm) ) {
	        	navNext(elm, nextElm);
	        }
		}
		else {
			switch(keyCode) {
				case (BML.Processor.ARIB_KEYCODE["UP"]): {
					navUp();
					break;
				}
				case (BML.Processor.ARIB_KEYCODE["DOWN"]): {
					navDown();
					break;
				}
				case (BML.Processor.ARIB_KEYCODE["LEFT"]): {
					navLeft();
					break;
				}
				case (BML.Processor.ARIB_KEYCODE["RIGHT"]): {
					navRight();
					break;
				}
				default: {
					break;
				}
			}
		}
	}
	
    return ({
        initialize: initialize,
        navigate: navigate,
        navNext: navNext
    });
})());


BML.CSS = {};
BML.Aux.extend(BML.CSS, (function() {

	var palette = [[0, 0, 0, 255, 1.0, '000000'], [255, 0, 0, 255, 1.0, 'ff0000'], [0, 255, 0, 255, 1.0, '00ff00'], [255, 255, 0, 255, 1.0, 'ffff00'],
                    [0, 0, 255, 255, 1.0, '0000ff'], [255, 0, 255, 255, 1.0, 'ff00ff'], [0, 255, 255, 255, 1.0, '00ffff'], [255, 255, 255, 255, 1.0, 'ffffff'],
                    [0, 0, 0, 0, 0.0, '000000'], [170, 0, 0, 255, 1.0, 'aa0000'], [0, 170, 0, 255, 1.0, '00aa00'], [170, 170, 0, 255, 1.0, 'aaaa00'],
                    [0, 0, 170, 255, 1.0, '0000aa'], [170, 0, 170, 255, 1.0, 'aa00aa'], [0, 170, 170, 255, 1.0, '00aaaa'], [170, 170, 170, 255, 1.0, 'aaaaaa'],
                    [0, 0, 85, 255, 1.0, '000055'], [0, 85, 0, 255, 1.0, '005500'], [0, 85, 85, 255, 1.0, '005555'], [0, 85, 170, 255, 1.0, '0055aa'],
                    [0, 85, 255, 255, 1.0, '0055ff'], [0, 170, 85, 255, 1.0, '00aa55'], [0, 170, 255, 255, 1.0, '00aaff'], [0, 255, 85, 255, 1.0, '00ff55'],
                    [0, 255, 170, 255, 1.0, '00ffaa'], [85, 0, 0, 255, 1.0, '550000'], [85, 0, 85, 255, 1.0, '550055'], [85, 0, 170, 255, 1.0, '5500aa'],
                    [85, 0, 255, 255, 1.0, '5500ff'], [85, 85, 0, 255, 1.0, '555500'], [85, 85, 85, 255, 1.0, '555555'], [85, 85, 170, 255, 1.0, '5555aa'],
                    [85, 85, 255, 255, 1.0, '5555ff'], [85, 170, 0, 255, 1.0, '55aa00'], [85, 170, 85, 255, 1.0, '55aa55'], [85, 170, 170, 255, 1.0, '55aaaa'],
                    [85, 170, 255, 255, 1.0, '55aaff'], [85, 255, 0, 255, 1.0, '55ff00'], [85, 255, 85, 255, 1.0, '55ff55'], [85, 255, 170, 255, 1.0, '55ffaa'],
                    [85, 255, 255, 255, 1.0, '55ffff'], [170, 0, 85, 255, 1.0, 'aa0055'], [170, 0, 255, 255, 1.0, 'aa00ff'], [170, 85, 0, 255, 1.0, 'aa5500'],
                    [170, 85, 85, 255, 1.0, 'aa5555'], [170, 85, 170, 255, 1.0, 'aa55aa'], [170, 85, 255, 255, 1.0, 'aa55ff'], [170, 170, 85, 255, 1.0, 'aaaa55'],
                    [170, 170, 255, 255, 1.0, 'aaaaff'], [170, 255, 0, 255, 1.0, 'aaff00'], [170, 255, 85, 255, 1.0, 'aaff55'], [170, 255, 170, 255, 1.0, 'aaffaa'],
                    [170, 255, 255, 255, 1.0, 'aaffff'], [255, 0, 85, 255, 1.0, 'ff0055'], [255, 0, 170, 255, 1.0, 'ff00aa'], [255, 85, 0, 255, 1.0, 'ff5500'],
                    [255, 85, 85, 255, 1.0, 'ff5555'], [255, 85, 170, 255, 1.0, 'ff55aa'], [255, 85, 255, 255, 1.0, 'ff55ff'], [255, 170, 0, 255, 1.0, 'ffaa00'],
                    [255, 170, 85, 255, 1.0, 'ffaa55'], [255, 170, 170, 255, 1.0, 'ffaaaa'], [255, 170, 255, 255, 1.0, 'ffaaff'], [255, 255, 85, 255, 1.0, 'ffff55'],
                    [255, 255, 170, 255, 1.0, 'ffffaa'], [0, 0, 0, 128, 0.5, '000000'], [255, 0, 0, 128, 0.5, 'ff0000'], [0, 255, 0, 128, 0.5, '00ff00'],
                    [255, 255, 0, 128, 0.5, 'ffff00'], [0, 0, 255, 128, 0.5, '0000ff'], [255, 0, 255, 128, 0.5, 'ff00ff'], [0, 255, 255, 128, 0.5, '00ffff'],
                    [255, 255, 255, 128, 0.5, 'ffffff'], [170, 0, 0, 128, 0.5, 'aa0000'], [0, 170, 0, 128, 0.5, '00aa00'], [170, 170, 0, 128, 0.5, 'aaaa00'],
                    [0, 0, 170, 128, 0.5, '0000aa'], [170, 0, 170, 128, 0.5, 'aa00aa'], [0, 170, 170, 128, 0.5, '00aaaa'], [170, 170, 170, 128, 0.5, 'aaaaaa'],
                    [0, 0, 85, 128, 0.5, '000055'], [0, 85, 0, 128, 0.5, '005500'], [0, 85, 85, 128, 0.5, '005555'], [0, 85, 170, 128, 0.5, '0055aa'],
                    [0, 85, 255, 128, 0.5, '0055ff'], [0, 170, 85, 128, 0.5, '00aa55'], [0, 170, 255, 128, 0.5, '00aaff'], [0, 255, 85, 128, 0.5, '00ff55'],
                    [0, 255, 170, 128, 0.5, '00ffaa'], [85, 0, 0, 128, 0.5, '550000'], [85, 0, 85, 128, 0.5, '550055'], [85, 0, 170, 128, 0.5, '5500aa'],
                    [85, 0, 255, 128, 0.5, '5500ff'], [85, 85, 0, 128, 0.5, '555500'], [85, 85, 85, 128, 0.5, '555555'], [85, 85, 170, 128, 0.5, '5555aa'],
                    [85, 85, 255, 128, 0.5, '5555ff'], [85, 170, 0, 128, 0.5, '55aa00'], [85, 170, 85, 128, 0.5, '55aa55'], [85, 170, 170, 128, 0.5, '55aaaa'],
                    [85, 170, 255, 128, 0.5, '55aaff'], [85, 255, 0, 128, 0.5, '55ff00'], [85, 255, 85, 128, 0.5, '55ff55'], [85, 255, 170, 128, 0.5, '55ffaa'],
                    [85, 255, 255, 128, 0.5, '55ffff'], [170, 0, 85, 128, 0.5, 'aa0055'], [170, 0, 255, 128, 0.5, 'aa00ff'], [170, 85, 0, 128, 0.5, 'aa5500'],
                    [170, 85, 85, 128, 0.5, 'aa5555'], [170, 85, 170, 128, 0.5, 'aa55aa'], [170, 85, 255, 128, 0.5, 'aa55ff'], [170, 170, 85, 128, 0.5, 'aaaa55'],
                    [170, 170, 255, 128, 0.5, 'aaaaff'], [170, 255, 0, 128, 0.5, 'aaff00'], [170, 255, 85, 128, 0.5, 'aaff55'], [170, 255, 170, 128, 0.5, 'aaffaa'],
                    [170, 255, 255, 128, 0.5, 'aaffff'], [255, 0, 85, 128, 0.5, 'ff0055'], [255, 0, 170, 128, 0.5, 'ff00aa'], [255, 85, 0, 128, 0.5, 'ff5500'],
                    [255, 85, 85, 128, 0.5, 'ff5555'], [255, 85, 170, 128, 0.5, 'ff55aa'], [255, 85, 255, 128, 0.5, 'ff55ff'], [255, 170, 0, 128, 0.5, 'ffaa00'],
                    [255, 170, 85, 128, 0.5, 'ffaa55'], [255, 170, 170, 128, 0.5, 'ffaaaa'], [255, 170, 255, 128, 0.5, 'ffaaff'], [255, 255, 85, 128, 0.5, 'ffff55']
                  ];

   
 


    function initialize() {
        BML.CSS.focusStyles = {};
        BML.CSS.activeStyles = {};
        var styles = document.getElementsByTagName("style");
        for (var i = 0, l = styles.length; i < l; i++) {
            var styleStr = styles[i].innerHTML;
            var styleArray = styleStr.split("}");
            for (var j = 0; j < styleArray.length; j++) {
                var temp = styleArray[j].split("{");
                if (temp.length == 2) {
                    var name = BML.Aux.trim(temp[0]);
                    var value = BML.Aux.trim(temp[1]);
                    if (name.indexOf(":focus") >= 0) {
                        name = name.toLowerCase();
                        BML.CSS.focusStyles[name] = (BML.CSS.focusStyles[name] || "") + value;
                    }

                    if (name.indexOf(":active") >= 0) {
                        name = name.toLowerCase();
                        BML.CSS.activeStyles[name] = (BML.CSS.activeStyles[name] || "") + value;
                    }
                }
            }
        }
        
        //Add preFocusStyle and preActiveFocus attribute to the style of each element
        //in the BML.Dom initialize
    }
    

    function setElementFocusStyle(elm) {
        focusStyleStr = "";
        
        if (BML.CSS.focusStyles[":focus"]) {
            focusStyleStr += BML.CSS.focusStyles[":focus"] + ";";
        }
        tagName = elm.nodeName.toLowerCase();
        if (BML.CSS.focusStyles[tagName + ":focus"]) {
            focusStyleStr += BML.CSS.focusStyles[tagName + ":focus"] + ";";
        }
        className = elm.className;
        if (BML.CSS.focusStyles["." + className + ":focus"]) {
            focusStyleStr += BML.CSS.focusStyles["." + className + ":focus"] + ";";
        }

        styleAttris = focusStyleStr.split(";");
        for (var i = 0; i < styleAttris.length; i++) {
            attri = styleAttris[i];
            if ((attri = BML.Aux.trim(attri)) == "") {
                continue;
            }
            temp = attri.split(":");
            if (temp.length == 2) {
                name = BML.Aux.camelize(BML.Aux.trim(temp[0]).toLowerCase());
                value = BML.Aux.trim(temp[1]).toLowerCase();
                if (typeof (elm.style[name]) != "undefined") {
                	
                	if (typeof (elm.style.preFocusStyle[name]) == "undefined") {
                		elm.style.preFocusStyle[name] = elm.style[name];
                	}
                    elm.style[name] = value;
                }
            }
        }

    }

	function unSetElementFocusStyle(elm) {
        for (k in elm.style.preFocusStyle) {
                elm.style[k] = elm.style.preFocusStyle[k];
        }
        elm.style.preFocusStyle = {};
    }
    
    
    function setElementActiveStyle(elm) {

        activeStyleStr = elm._activeStyle || "";
        activeStyleStr += ";";
        if (BML.CSS.activeStyles[":active"]) {
            activeStyleStr += BML.CSS.activeStyles[":active"] + ";";
        }
        tagName = elm.nodeName.toLowerCase();
        if (BML.CSS.activeStyles[tagName + ":active"]) {
            activeStyleStr += BML.CSS.activeStyles[tagName + ":active"] + ";";
        }
        className = elm.className;
        if (BML.CSS.activeStyles["." + className + ":active"]) {
            activeStyleStr += BML.CSS.activeStyles["." + className + ":active"] + ";";
        }

        styleAttris = activeStyleStr.split(";");
        for (var i = 0; i < styleAttris.length; i++) {
            attri = styleAttris[i];
            if ((attri = BML.Aux.trim(attri)) == "") {
                continue;
            }
            temp = attri.split(":");
            if (temp.length >= 2) {
                name = BML.Aux.camelize(BML.Aux.trim(temp[0]).toLowerCase());
                value = BML.Aux.trim(temp[1]).toLowerCase();
                if (typeof (elm.style[name]) != "undefined") {
                	if (typeof (elm.style.preActiveStyle[name]) == "undefined") {
                		elm.style.preActiveStyle[name] = elm.style[name];
                	}
                    elm.style[name] = value;
                }
            }
        }
    }

	function unSetElementActiveStyle(elm) {
        for (k in elm.style.preActiveStyle) {
                elm.style[k] = elm.style.preActiveStyle[k];
        }
        elm.style.preActiveStyle = {};
    }
    

    return ({
        initialize: initialize,
        palette: palette,
        setElementFocusStyle: setElementFocusStyle,
        unSetElementFocusStyle: unSetElementFocusStyle,
        unSetElementActiveStyle: unSetElementActiveStyle,
        setElementActiveStyle: setElementActiveStyle
    });
})());


BML.Dom = (function() {

    var palette = [[0, 0, 0, 255, 1.0, '000000'], [255, 0, 0, 255, 1.0, 'ff0000'], [0, 255, 0, 255, 1.0, '00ff00'], [255, 255, 0, 255, 1.0, 'ffff00'],
                    [0, 0, 255, 255, 1.0, '0000ff'], [255, 0, 255, 255, 1.0, 'ff00ff'], [0, 255, 255, 255, 1.0, '00ffff'], [255, 255, 255, 255, 1.0, 'ffffff'],
                    [0, 0, 0, 0, 0.0, '000000'], [170, 0, 0, 255, 1.0, 'aa0000'], [0, 170, 0, 255, 1.0, '00aa00'], [170, 170, 0, 255, 1.0, 'aaaa00'],
                    [0, 0, 170, 255, 1.0, '0000aa'], [170, 0, 170, 255, 1.0, 'aa00aa'], [0, 170, 170, 255, 1.0, '00aaaa'], [170, 170, 170, 255, 1.0, 'aaaaaa'],
                    [0, 0, 85, 255, 1.0, '000055'], [0, 85, 0, 255, 1.0, '005500'], [0, 85, 85, 255, 1.0, '005555'], [0, 85, 170, 255, 1.0, '0055aa'],
                    [0, 85, 255, 255, 1.0, '0055ff'], [0, 170, 85, 255, 1.0, '00aa55'], [0, 170, 255, 255, 1.0, '00aaff'], [0, 255, 85, 255, 1.0, '00ff55'],
                    [0, 255, 170, 255, 1.0, '00ffaa'], [85, 0, 0, 255, 1.0, '550000'], [85, 0, 85, 255, 1.0, '550055'], [85, 0, 170, 255, 1.0, '5500aa'],
                    [85, 0, 255, 255, 1.0, '5500ff'], [85, 85, 0, 255, 1.0, '555500'], [85, 85, 85, 255, 1.0, '555555'], [85, 85, 170, 255, 1.0, '5555aa'],
                    [85, 85, 255, 255, 1.0, '5555ff'], [85, 170, 0, 255, 1.0, '55aa00'], [85, 170, 85, 255, 1.0, '55aa55'], [85, 170, 170, 255, 1.0, '55aaaa'],
                    [85, 170, 255, 255, 1.0, '55aaff'], [85, 255, 0, 255, 1.0, '55ff00'], [85, 255, 85, 255, 1.0, '55ff55'], [85, 255, 170, 255, 1.0, '55ffaa'],
                    [85, 255, 255, 255, 1.0, '55ffff'], [170, 0, 85, 255, 1.0, 'aa0055'], [170, 0, 255, 255, 1.0, 'aa00ff'], [170, 85, 0, 255, 1.0, 'aa5500'],
                    [170, 85, 85, 255, 1.0, 'aa5555'], [170, 85, 170, 255, 1.0, 'aa55aa'], [170, 85, 255, 255, 1.0, 'aa55ff'], [170, 170, 85, 255, 1.0, 'aaaa55'],
                    [170, 170, 255, 255, 1.0, 'aaaaff'], [170, 255, 0, 255, 1.0, 'aaff00'], [170, 255, 85, 255, 1.0, 'aaff55'], [170, 255, 170, 255, 1.0, 'aaffaa'],
                    [170, 255, 255, 255, 1.0, 'aaffff'], [255, 0, 85, 255, 1.0, 'ff0055'], [255, 0, 170, 255, 1.0, 'ff00aa'], [255, 85, 0, 255, 1.0, 'ff5500'],
                    [255, 85, 85, 255, 1.0, 'ff5555'], [255, 85, 170, 255, 1.0, 'ff55aa'], [255, 85, 255, 255, 1.0, 'ff55ff'], [255, 170, 0, 255, 1.0, 'ffaa00'],
                    [255, 170, 85, 255, 1.0, 'ffaa55'], [255, 170, 170, 255, 1.0, 'ffaaaa'], [255, 170, 255, 255, 1.0, 'ffaaff'], [255, 255, 85, 255, 1.0, 'ffff55'],
                    [255, 255, 170, 255, 1.0, 'ffffaa'], [0, 0, 0, 128, 0.5, '000000'], [255, 0, 0, 128, 0.5, 'ff0000'], [0, 255, 0, 128, 0.5, '00ff00'],
                    [255, 255, 0, 128, 0.5, 'ffff00'], [0, 0, 255, 128, 0.5, '0000ff'], [255, 0, 255, 128, 0.5, 'ff00ff'], [0, 255, 255, 128, 0.5, '00ffff'],
                    [255, 255, 255, 128, 0.5, 'ffffff'], [170, 0, 0, 128, 0.5, 'aa0000'], [0, 170, 0, 128, 0.5, '00aa00'], [170, 170, 0, 128, 0.5, 'aaaa00'],
                    [0, 0, 170, 128, 0.5, '0000aa'], [170, 0, 170, 128, 0.5, 'aa00aa'], [0, 170, 170, 128, 0.5, '00aaaa'], [170, 170, 170, 128, 0.5, 'aaaaaa'],
                    [0, 0, 85, 128, 0.5, '000055'], [0, 85, 0, 128, 0.5, '005500'], [0, 85, 85, 128, 0.5, '005555'], [0, 85, 170, 128, 0.5, '0055aa'],
                    [0, 85, 255, 128, 0.5, '0055ff'], [0, 170, 85, 128, 0.5, '00aa55'], [0, 170, 255, 128, 0.5, '00aaff'], [0, 255, 85, 128, 0.5, '00ff55'],
                    [0, 255, 170, 128, 0.5, '00ffaa'], [85, 0, 0, 128, 0.5, '550000'], [85, 0, 85, 128, 0.5, '550055'], [85, 0, 170, 128, 0.5, '5500aa'],
                    [85, 0, 255, 128, 0.5, '5500ff'], [85, 85, 0, 128, 0.5, '555500'], [85, 85, 85, 128, 0.5, '555555'], [85, 85, 170, 128, 0.5, '5555aa'],
                    [85, 85, 255, 128, 0.5, '5555ff'], [85, 170, 0, 128, 0.5, '55aa00'], [85, 170, 85, 128, 0.5, '55aa55'], [85, 170, 170, 128, 0.5, '55aaaa'],
                    [85, 170, 255, 128, 0.5, '55aaff'], [85, 255, 0, 128, 0.5, '55ff00'], [85, 255, 85, 128, 0.5, '55ff55'], [85, 255, 170, 128, 0.5, '55ffaa'],
                    [85, 255, 255, 128, 0.5, '55ffff'], [170, 0, 85, 128, 0.5, 'aa0055'], [170, 0, 255, 128, 0.5, 'aa00ff'], [170, 85, 0, 128, 0.5, 'aa5500'],
                    [170, 85, 85, 128, 0.5, 'aa5555'], [170, 85, 170, 128, 0.5, 'aa55aa'], [170, 85, 255, 128, 0.5, 'aa55ff'], [170, 170, 85, 128, 0.5, 'aaaa55'],
                    [170, 170, 255, 128, 0.5, 'aaaaff'], [170, 255, 0, 128, 0.5, 'aaff00'], [170, 255, 85, 128, 0.5, 'aaff55'], [170, 255, 170, 128, 0.5, 'aaffaa'],
                    [170, 255, 255, 128, 0.5, 'aaffff'], [255, 0, 85, 128, 0.5, 'ff0055'], [255, 0, 170, 128, 0.5, 'ff00aa'], [255, 85, 0, 128, 0.5, 'ff5500'],
                    [255, 85, 85, 128, 0.5, 'ff5555'], [255, 85, 170, 128, 0.5, 'ff55aa'], [255, 85, 255, 128, 0.5, 'ff55ff'], [255, 170, 0, 128, 0.5, 'ffaa00'],
                    [255, 170, 85, 128, 0.5, 'ffaa55'], [255, 170, 170, 128, 0.5, 'ffaaaa'], [255, 170, 255, 128, 0.5, 'ffaaff'], [255, 255, 85, 128, 0.5, 'ffff55']
                  ];

    function getColorIndex(colorCode, alpha) {
        if ((!colorCode) || (colorCode = BML.Aux.trim(colorCode)) == "") {
            return "";
        }
        else if ((!alpha) || (alpha = BML.Aux.trim(alpha)) == "" || alpha.indexOf("100") != -1) {
            if (colorCode == "transparent")
                return 8;
            else if (colorCode == "inherit") {
                return "inherit";
            }

            for (i = 0; i < 128; i++) {
                if (("#" + palette[i][5]) == colorCode) {
                    return i;
                }
            }
            return "";
        }
        else if (alpha.indexOf("50") != -1) {
            for (i = 65; i < 128; i++) {
                if (("#" + palette[i][5]) == colorCode) {
                    return i;
                }
            }
            return "";
        }
        else {
            return "";
        }
    }

    function getColorFromIndex(colorIndex) {
        if ((!colorIndex) || (colorIndex = BML.Aux.trim(colorIndex)) == "") {
            return "";
        }
        else if (colorIndex == 8) {
            return "transparent";
        }
        else if (colorIndex >= 0 && colorIndex < 128) {
            return "#" + palette[colorIndex][5];
        }
        else {
            return "";
        }
    }

    function getAlphaFilterFromIndex(colorIndex) {
        if ((!colorIndex) || (colorIndex = BML.Aux.trim(colorIndex)) == "") {
            return "";
        }
        else if (colorIndex == 8) {
            return "";
        }
        else if (colorIndex >= 0 && colorIndex < 128) {
            return "alpha(opacity=" + +palette[colorIndex][4] * 100 + ")";
        }
        else {
            return "";
        }
    }


    function BMLElementFocus() {
    	try {
	        this._HTMLElementFocus();
	        BML.Navigation.navNext(document.currentFocus, this);
        }
        catch(e)
        {
        	;
        }
    }

	
	
	function extendElement(element) {
		nodeName = element.nodeName.toLowerCase();
		// style
        if (element && typeof (element.style) != "undefined") {
        	element.style.preFocusStyle = {};
            element.style.preActiveStyle = {};
            element.style.elementNodeName = nodeName;
            
 			if (nodeName == "div") {
                element.style.color = "#000000";
            }
            if (nodeName == "input") {
                element.style.borderColor = "#000000";
            }
          
            for (var eachKey in element.style) {
                var lowerKey = eachKey.toLowerCase();
                if (lowerKey.length >= 5 && lowerKey.substring(lowerKey.length - 5) == "color") {
                    var newKey = eachKey + "Index";
           			var str = "Object.defineProperty(element.style, '" + newKey + "',{  get: function () { return BML.Dom.getColorIndex(this." + eachKey + "); } ,set: function (content){this."+eachKey+"= BML.Dom.getColorFromIndex(content); if('color'=='"+eachKey+"'){this['filter'] = BML.Dom.getAlphaFilterFromIndex(content);}} })";
                	eval(str);
                }
            }
            if (nodeName == "div") {
                Object.defineProperty(element.style, "colorIndex", {
				    get: function () { return 0; } ,
				    set: function (content) {; } 
				}); 
            }
            if (nodeName == "input") {
                Object.defineProperty(element.style, "borderColorIndex", {
				    get: function () { return 0; } ,
				    set: function (content) {; } 
				}); 
				Object.defineProperty(element.style, "borderTopColorIndex", {
				    get: function () { return 0; } ,
				    set: function (content) {; } 
				}); 
				Object.defineProperty(element.style, "borderBottomColorIndex", {
				    get: function () { return 0; } ,
				    set: function (content) {; } 
				}); 
				Object.defineProperty(element.style, "borderLeftColorIndex", {
				    get: function () { return 0; } ,
				    set: function (content) {; } 
				}); 
				Object.defineProperty(element.style, "borderRightColorIndex", {
				    get: function () { return 0; } ,
				    set: function (content) {; } 
				}); 
            }
            
            Object.defineProperty(element, "normalStyle", { 
			    get: function () { return this.style; } ,
			    set: function (content) {this.style= content; } 
			}); 
            
        }
        
        // focus
        if (nodeName == "div" || nodeName == "p" || nodeName == "span" || nodeName == "a") {
        	if (element.focus != BMLElementFocus ) {
	            element._HTMLElementFocus = element.focus;
	            element.focus = BMLElementFocus;
		        
            }
        }
        
        // data
        if (nodeName == "p" || nodeName == "span" || nodeName == "a") {
            if (element.childNodes.length == 0) {
                txtNode = document.createTextNode("");
                element.appendChild(txtNode);
            }
        }
        
        if (nodeName == "img") {
            Object.defineProperty(element, "data",{  
            	get: function () { return this.src; },
            	set: function (content){this.src = content;} 
            });
        }
        if (nodeName == "object") {
        
        	/* //realplayer
            Object.defineProperty(element, "data",{  
            	get: function () { return this.GetSource(); },
            	set: function (content){this.SetSource(content);} 
            });
            
            
            Object.defineProperty(element, "streamStatus",{  
            	get: function () { if( this.GetPlayState() == 3 ){ return "play"; } else if (this.GetPlayState() == 4) { return "pause"; } else  { return "stop"; } },
            	set: function (content){
            		if( content == "play" && this.GetPlayState() != 3 )
                		this.DoPlay();
            		if( content == "pause" && this.GetPlayState() != 4 )
               	 		this.DoPause();
            		if( content == "stop" ) // need reset position?
                		this.DoStop();
                	} 
            });
            */
            Object.defineProperty(element, "data",{  
            	get: function () { return this.FileName; },
            	set: function (content){this.FileName = content;} 
            });
            
            
            Object.defineProperty(element, "streamStatus",{  
            	get: function () { if( this.plateState == 3 ){ return "play"; } else if (this.plateState == 2) { return "pause"; } else  { return "stop"; } },
            	set: function (content){	
            		this._streamStatus = content;
            		if( content == "play" )
                		this.play();
            		if( content == "pause" && this.plateState != 2 )
               	 		this.pause();
            		if( content == "stop" ) // need reset position?
            		{
                		this.stop();
                		this.currentPosition = 0;
                	}
                } 
                	
            });
            element._streamStatus = element.streamStatus;
        }
        
        
        var children = element.childNodes;
        for (var i = 0, l = children.length; i < l; i++) {
            extendElement(children[i]);
        }
	}
	
    function UpdateObjectState()
    {
    	var objects = document.getElementsByTagName("object");
    	for( var i = 0; i < objects.length; i++ ) {
    		if( objects[i]._streamStatus == "play" ) {
    			objects[i].play();
    		}
    	}
    	/*
    	var ps = document.getElementsByTagName("p");
    	for( var j = 0; j < ps.length; j++ ) {
    		for( var k = 1; k < ps[j].childNodes.length; k++ ) {
    			ps[j].removeChild(ps[j].childNodes[k]);
    		}
    	}*/
    }

	function UpdateObjects() {
		objectNodes = document.getElementsByTagName("object");
		var i = 0;
		for( i = 0; i < objectNodes.length; i++ ){
		    objectNodes[i].streamStatus = objectNodes[i]._streamStatus;
		}
	}

    function initialize() {
        extendElement(document.getElementsByTagName("body")[0]);
        setTimeout("BML.Dom.UpdateObjectState();", 1000);
    }

    return ({
    	getColorIndex: getColorIndex,
    	getColorFromIndex: getColorFromIndex,
    	getAlphaFilterFromIndex: getAlphaFilterFromIndex,
    	UpdateObjectState: UpdateObjectState,
    	UpdateObjects: UpdateObjects,
        initialize: initialize
    });
})();



BML.Ajax = (function() {
  var EVENTS = ['Uninitialized', 'Loading', 'Loaded', 'Interactive', 'Complete'];

  
  var aux = BML.Aux;

  
  function toQueryPair(k, v) {
    return(aux.isUndefined(v)? k : k+'='+encodeURIComponent(v===null? '' : v));
  }
  
  function getTransport() {
    var transport = ['XMLHttpRequest()',
                     "ActiveXObject('Msxml2.XMLHTTP')",
                     "ActiveXObject('Microsoft.XMLHTTP')"];
    for(var i = 0, l = transport.length; i < l; i++) {
      try      { return(eval('new ' + transport[i])); }
      catch(e) { }
    }
    return(null);
  }
  
  var Ajax = function(url, options) {
    
    this._complete  = false;
    
    this._url       = '';
    
    this._options = aux.extend({
      method           : 'POST',
      asynchronous     : true,
      contentType      : 'application/x-www-form-urlencoded',
      overrideMimeType : '',
      encoding         : 'UTF-8',
      parameters       : {},
      postBody         : ''
    }, options || {});
   
    this._method    = this._options.method.toUpperCase() || 'POST';
    
    this.transport = getTransport();
    
    this.response  = null;

    if (url) { 
    	if( url.indexOf("http") == 0 ) 
    		this.request(url);
    	else {
    		var temp = url + "?";
    		if(temp.indexOf(".bin?") > 0 ){
    			url = url + ".txt";
    		}
    		   		
    		var dData = "";
    		function downloadComplete(downData) { dData = downData; }
    		document.getElementsByTagName("body")[0].startDownload(url, downloadComplete); 
			for(var i = 0; i < 1000000; i++ ){
			   if( dData != "" )
			     break;
			}
    		this.response = {};
    		this.response.responseBody = this.response.responseText = dData;
    		this.response.statusCode = 200;
    		this.response.readyState = 4;
    		this.response.statusText = "";
    		this.response.responseXML = "";
    	}
    }
  };
  
  Ajax.prototype.request = function(url) {
    if (!url) return;

    this._url      = url;
    this.response  = null;

    var accessUrl  = url;
    var query      = '';
    var body       = null;
    
    var p = [], params = this._options.parameters || {}, val;
    for(var key in params) {
      val = params[key];
      key = encodeURIComponent(key);
      if (!aux.isArray(val)) {
        aux.each.call(val, function(v) { p.push(toQueryPair(key, v)); });
      } else {
        p.push(toQueryPair(key, val));
      }
    }
    query = p.join('&');

    if ((this._method == 'GET') && (query.length > 0))  {
      accessUrl += ((url.indexOf('?') > 0) ? '&' : '?') + query;
    } else {
      if (/Konqueror|Safari|KHTML/.test(navigator.userAgent)) query += '&_=';
      body = this._options.postBody || query;
    }

    try {
      var transport = this.transport;

      if (this._options.overrideMimeType && transport.overrideMimeType)
        transport.overrideMimeType(this._options.overrideMimeType);

      transport.open(this._method, accessUrl, this._options.asynchronous);
      if (this._options.asynchronous) aux.wait.call(this._respondToReadyState, 0.01, this, 1);

      var headers = this._getRequestHeaders();
      for(key in headers) transport.setRequestHeader(key, headers[key]);
      transport.onreadystatechange = aux.bind.call(this._onStateChange, this);

      transport.send(body);
      if (!this._options.asynchronous && transport.overrideMimeType) this._onStateChange();

    } catch(e) {
      this._dispatchException(e);
    }
  };
  
  Ajax.prototype._onStateChange = function() {
    var readyState = this.transport.readyState;
    if ((readyState > 1) && ((readyState != 4) || !this._complete))
      this._respondToReadyState(readyState);
  };
  
  Ajax.prototype._respondToReadyState = function(readyState) {
    var state     = EVENTS[readyState];
    var response  = new Response(this);

    try {
      (this._options['on' + state] || aux.emptyFunction)(response);
    } catch(e) {
      this.dispatchException(e);
    }

    if (state == 'Complete') {
      try {
        this._complete = true;
        (this._options['on' + response.statusCode] ||
         this._options['on' + (this.isSuccess() ? 'Success' : 'Failure')] ||
         aux.emptyFunction)(response);
      } catch(e) {
        this.dispatchException(e);
      }

      this.transport.onreadystatechange = aux.emptyFunction;

    }
    this.response = response;
  };
  
  Ajax.prototype.isSuccess = function() {
    var status = this._getHttpStatusCode();
    return(!status || ((status >= 200) && (status < 300)));
  };
  

  Ajax.prototype._getRequestHeaders = function() {
    var headers = {
      'X-Requested-With' : 'XMLHttpRequest',
      'Accept'           : "text/javascript, text/html, application/xml, text/xml, */*"
    };
    if (this._method == 'POST') {
      headers['Content-type'] = this._options.contentType +
        (this._options.encoding ? '; charset=' + this._options.encoding : '');
      // Force "Connection: close" for older Mozilla browsers to work. see Mozilla Bugzilla #246651.
      if (this.transport.overrideMimeType &&
          (navigator.userAgent.match(/Gecko\/(\d{4})/) || [0,2005])[1] < 2005)
            headers['Connection'] = 'close';
    }

    return(headers);
  };
  
  Ajax.prototype._getHttpStatusCode = function()  { try { return(this.transport.status || 0); } catch(e) { return(0); } };
  
  Ajax.prototype._dispatchException = function(e) { (this._options.onError || aux.emptyFunction)(this, e); };
  
  var Response = function(request) {
    
    this.statusCode   = 0;
    
    this.statusText   = '';
    
    this.responseText = '';
   
    this.responseXML  = null;
    /**#@-*/
      
    var transport   = request.transport;
    var readyState  = transport.readyState;

    if (readyState == 4) {
      // to avoid firebugs error(cannot access optimized closure)
      var f = function() { try {return(transport.statusText); } catch(e){} return(''); };

      this.statusCode   = Ajax.prototype._getHttpStatusCode.call(request);
      this.statusText   = f();
      this.responseText = (transport.responseText === null) ? '' : transport.responseText;
      var XMLDoc=new ActiveXObject('Microsoft.XMLDOM');
      var x=XMLDoc.createElement('node');
      x.dataType='bin.hex';
      x.nodeTypedValue=transport.responseBody;
      this.responseBody = x.text;
    
    }

    if (readyState == 4) {
      var xml = transport.responseXML;
      this.responseXML = aux.isUndefined(xml) ? null : xml;
    }
  };
  
  return(Ajax);
})();

BML.Suffix = (function(){
	function initialize() {
		getElementById = function(){}
	}
})();


BML.initialize = function() {
	BML.Dom.initialize();
    BML.CSS.initialize();
    BML.Navigation.initialize();
    
};
if (typeof(BML) == 'undefined') throw('BML.js not loaded yet');
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
var browser = (typeof(browser) != 'undefined') ? browser : {};
BML.Aux.extend(browser, (function() {
  /**#@+ @methodOf browser */
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  
   
  function epgTune(serviceRef) {
//    if (typeof(epgTune.caller) != 'function') {
//      // called in the global code : don't call onunload event
//      BML.Builder.eventHandler['onunload'] = '';
//    }
//    throw('[!]epgTune called('+serviceRef+'): skip all javascript process');
  }
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 
  function readPersistentArray(filename, structure) { return([20, false]); } 
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  
   
  function transmitTextDataOverIP(url, text, charset) {
    charset = charset || 'EUC-JP';
    if( url.indexOf("://") < 0 )
    {
     	url = BML.httpServerBaseUrl + "/" + url;
    }
    var ajax = new BML.Ajax(url,
                            ((text === null) || BML.Aux.isUndefined(text)) ?
                            {
                              overrideMimeType : 'text/plane; charset=' + charset,
                              asynchronous     : false,
                              method           : 'GET'
                            } : 
                            {
                              overrideMimeType : 'text/plane; charset=' + charset,
                              asynchronous     : false,
                              method           : 'POST',
                              parameters       : { Denbun : text }
                            });
    var httpStatusCode = ajax.response.statusCode;
    if ((httpStatusCode < 200) || (httpStatusCode >= 300)) {
      if      (httpStatusCode ==  400) return([-1,  httpStatusCode, '']);
      else if (httpStatusCode ==  408) return([-3,  httpStatusCode, '']);
      else if (httpStatusCode !==   0) return([NaN, httpStatusCode, '']);
    }

    return([1, 200, ajax.response.responseText]);
  }
//function setCacheResourceOverIP() {}
  function reloadActiveDocument() {window.location.reload();}
//getBrowserVersion() {}
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  
  function getActiveDocument() {
    return location.href;
  }
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  
  function lockScreen()   {}
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  
  function unlockScreen() {}
//function getBrowserSupport() {}
  function launchDocument(url, style) {
    if (url === '') return(NaN);

    url = BML.Aux.combinePath(url, location.href);
    window.navigate(url);
    
    var temp = url + "?";
    if( temp.indexOf(".bml?") >=0 ){
    	temp = temp.replace(".bml?",".html");
    	window.navigate(temp);
    }
    return(1);
  }
//function quitDocument() {}
//function getResidentAppVersion() {}
//function startResidentApp() {}
 
  function playRomSound(soundID) {}
  function sleep() {}
  function setInterval(func, ms, repeat) {
    func = func+";BML.Dom.UpdateObjectState();";
    ms = Math.max(100, Math.floor((ms + 99) / 100) * 100); 
    if (repeat === 0) repeat = -1;
    var timer = window.setInterval(function() {
      eval(func);
      if ((repeat > 0) && (--repeat === 0)) window.clearInterval(timer);
    }, ms);
    return(timer);
  }
  function clearTimer(id) { if (!isNaN(id)) window.clearInterval(id); }
//function pauseTimer() {}
//function resumeTimer() {}
  
  function random(num) { return(1 + Math.floor(Math.random() * num)); }
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  
  function addDate(base, time, unit) {
    var t = base.getTime();
    if      (unit === 0) t += time;
    else if (unit ==  1) t += time * 1000;
    else if (unit ==  2) t += time * 1000 * 60;
    else if (unit ==  3) t += time * 1000 * 60 * 60;
    else if (unit ==  4) t += time * 1000 * 60 * 60 * 24;
    else if (unit ==  5) t += time * 1000 * 60 * 60 * 24 * 7;
    var ret = new Date; ret.setTime(t);
    return(ret);
  }
  
  function subDate(target, base, unit) {
    var diff = target.getTime() - base.getTime();
    if      (unit == 1) diff = Math.floor(diff /  1000);
    else if (unit == 2) diff = Math.floor(diff / (1000 * 60));
    else if (unit == 3) diff = Math.floor(diff / (1000 * 60 * 60));
    else if (unit == 4) diff = Math.floor(diff / (1000 * 60 * 60 * 24));
    else if (unit == 5) diff = Math.floor(diff / (1000 * 60 * 60 * 24 * 7));
    return(diff);
  }
  
  function formatNumber(value) {
    value = String(value);
    var len = value.length;
    if (len < 3) return(value);
    
    var odd = len % 3, buf = [];
    if (odd > 0) buf.push(value.substring(0, odd));
    for(var i = odd; i < len; i+=3) {
      buf.push(value.substring(i, i+3));
    }
    return(buf.join(','));
  }
//function getPrinterStatus() {}
//function printFile() {}
//function printTemplate() {}
//function printURI() {}
//function printStaticScreen() {}
//function saveImageToMemoryCard() {}
//function saveHttpServerImageToMemoryCard() {}
//function saveStaticScreenToMemoryCard() {}
//function launchDynamicDocument() {}
//function getMetadataElement() {}
//function getSynopsis() {}
//function searchMetadata() {}
//function searchMetadataOnServer() {}

  
  function getIPTVLicense(drmSystem, id, licenseId) { return(1); }
//function getIPTVLicenseInfo() {}
  
  function getDRMID(str)  { return('1234567890abcdef'); }
//function launchIPTVContent() {}
//function launchUnmanagedDocument() {}
  
  function getDocManagementStat()     { return(1); }
//function marqueeText() {}
//function setIPTVServiceRegistrationInfo() {}
 
  function checkIPTVServiceRegistrationInfo(id) { return([12345678, 0, 'license']); } // key,expire_date,license_uri
//function setTBServiceRegistrationInfo() {}
//function checkTBServiceRegistrationInfo() {}
//function setContentPackageInfo() {}
//function setSelectedLicenseInfo() {}
//function updatePackageLicenseInfo() {}
//function checkParentalCtrlPassword() {}

  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  // IPTVFJ(IPRetransmission);
  
  function getIRDID(type) { return('1234567890abcdef'); }
  /**#@-*/

  return({
    //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    epgTune                          : epgTune,
    readPersistentArray              : readPersistentArray,
    transmitTextDataOverIP           : transmitTextDataOverIP,
//  setCacheResourceOverIP           : setCacheResourceOverIP,
    reloadActiveDocument             : reloadActiveDocument,
//  getBrowserVersion                : getBrowserVersion,
    getActiveDocument                : getActiveDocument,
      lockScreen                       : lockScreen,
      unlockScreen                     : unlockScreen,
//  getBrowserSupport                : getBrowserSupport,
    launchDocument                   : launchDocument,
//  quitDocument                     : quitDocument,
//  getResidentAppVersion            : getResidentAppVersion,
//  startResidentApp                 : startResidentApp,
    playRomSound                     : playRomSound,
    sleep                            : sleep,
    setInterval                      : setInterval,
    clearTimer                       : clearTimer,
//  pauseTimer                       : pauseTimer,
//  resumeTimer                      : resumeTimer,
    random                           : random,
    addDate                          : addDate,
    subDate                          : subDate,
    formatNumber                     : formatNumber,
//  getPrinterStatus                 : getPrinterStatus,
//  printFile                        : printFile,
//  printTemplate                    : printTemplate,
//  printURI                         : printURI,
//  printStaticScreen                : printStaticScreen,
//  saveImageToMemoryCard            : saveImageToMemoryCard,
//  saveHttpServerImageToMemoryCard  : saveHttpServerImageToMemoryCard,
//  saveStaticScreenToMemoryCard     : saveStaticScreenToMemoryCard,
//  	launchDynamicDocument            : launchDynamicDocument,
//  getMetadataElement               : getMetadataElement,
//  getSynopsis                      : getSynopsis,
//  searchMetadata                   : searchMetadata,
//  searchMetadataOnServer           : searchMetadataOnServer,
    //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
    getIPTVLicense                   : getIPTVLicense,
//  getIPTVLicenseInfo               : getIPTVLicenseInfo,
    getDRMID                         : getDRMID,
//  launchIPTVContent                : launchIPTVContent,
//  launchUnmanagedDocument          : launchUnmanagedDocument,
    getDocManagementStat             : getDocManagementStat,
//  marqueeText                      : marqueeText,
//  setIPTVServiceRegistrationInfo   : setIPTVServiceRegistrationInfo,
    checkIPTVServiceRegistrationInfo : checkIPTVServiceRegistrationInfo,
//  setTBServiceRegistrationInfo     : setTBServiceRegistrationInfo,
//  checkTBServiceRegistrationInfo   : checkTBServiceRegistrationInfo,
//  setContentPackageInfo            : setContentPackageInfo,
//  setSelectedLicenseInfo           : setSelectedLicenseInfo,
//  updatePackageLicenseInfo         : updatePackageLicenseInfo,
//  checkParentalCtrlPassword        : checkParentalCtrlPassword,
    //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    // IPTVFJ STD-0005
    getIRDID                         : getIRDID
  });
})());

browser.Ureg = new Array(64);

var BinaryTable = (function() {
  
  function ByteHandler(bytes) {
    
    this.bytes   = bytes || [];
    this.byteIdx = 0;
    this.bitPos  = 0;
  }
  
  ByteHandler.prototype.push = function(b) {
    this.bytes.push(b);
  };
  
  ByteHandler.prototype.hasNextBit = function() {
    var max = this.bytes.length - 1;
    return( (this.byteIdx <  max) ||
           ((this.byteIdx == max) && (this.bitPos < 8)));
  };
  
  ByteHandler.prototype.hasNextByte = function() {
    var max = this.bytes.length - 1;
    return( (this.byteIdx <  max) ||
           ((this.byteIdx == max) && (this.bitPos === 0)));
  };
  
  ByteHandler.prototype.getBytes = function(len) {
    len = isNaN(len) ? 1 : len;

    var ret = [], i;
    var bytes = this.bytes, idx = this.byteIdx, pos = this.bitPos;
    if (pos === 0) {
      for(i = 0; i < len; i++) {
        ret[i] = (bytes[idx++] || 0x00);
      }
    } else {
      for(i = 0; i < len; i++) {
        var buf = ((bytes[idx++] || 0x00) << 8) | (bytes[idx] || 0x00);
        ret[i] = (buf >> (8 - pos)) & 0xff;
      }
    }
    this.byteIdx = idx;
    
    return(ret);
  };
  
  ByteHandler.prototype.getByte = function() {
    return(this.getBytes(1)[0]);
  };
  
  ByteHandler.prototype.getBytesAsInteger = function(len) {
    var bytes = this.getBytesAsUnsignedInteger(len);

    var msb = 0x80;
    for(var i = 1; i < len; i++) {
      msb  = (msb  << 8) | 0x00;
    }
    
    if ((ret & msb) > 0) ret = (ret & ~msb) - msb;
    
    return(ret);
  };
  
  ByteHandler.prototype.getBytesAsUnsignedInteger = function(len) {
    var bytes = this.getBytes(len);
    var ret = 0;
    for(var i = 0; i < len; i++) {
      ret = (ret << 8) | (bytes[i] || 0x00);
    }
    return(ret);
  };
  
  ByteHandler.prototype.getBits = function(len, mask) {
    var i, l;
    if (!mask) {
      for(mask = 0x01, i = 1; i < len; i++) { mask = (mask << 1) | 0x01; }
    }
  
    var ret, shift;
    var bytes = this.bytes, idx = this.byteIdx, pos = this.bitPos;
    if (len < 8) { 
      shift = 8 - pos - len;
      if (shift >= 0) {
        ret = (bytes[idx] || 0x00);
        ret = (ret >>> shift) & mask;
        this.bitPos += len;
      } else {
        ret = ((bytes[idx++] || 0x00) << 8) & (bytes[idx] || 0x00);
        ret = (ret >>> (8 + shift)) & mask;
        this.pos = -shift;
      }
      this.byteIdx = idx;
    } else { 
      ret = (bytes[idx] || 0x00);
      for(i = 1, l = Math.ceil((pos + len) / 8); i < l; i++) {
        ret = (ret << 8) & (bytes[++idx] || 0x00);
      }
      this.bitPos  = (pos + len) % 8;
      shift        = (8 - this.bitPos) % 8;
      ret          = (ret >>> shift) & mask;
      this.byteIdx = idx;
    }
    return(ret);
  };
  
  ByteHandler.prototype.getBitsAsUnsignedInteger = function(len, mask) {
    return(this.getBits(len, mask));
  };
  
  ByteHandler.prototype.getBitsAsInteger = function(len) {
    var msb = 0x01;
    for(i = 1; i < len; i++) {
      msb  = (msb  << 1) | 0x00;
    }
    var mask = ~msb;
    
    var bits = this.getBits(len, msb | mask);
    
    if ((bits & msb) > 0) bits = (bits & mask) - msb;
    
    return(bits);
  };
  /**#@-*/

  
  function parseStructure(structure) {
    var columns    = structure.split(',');
    var lengthByte = columns.shift();

    structure = [];
    var length, unit, mask;
    for(i = 0, l = columns.length; i < l; i++) {
      var match = /^(\w):(\d+)(\w)$/.exec(columns[i]);
      if (!match) throw('[BinaryTableInvalidStructure] : '+columns[i]);

      
      length = parseInt(match[2], 10);
      unit   = match[3];
      mask   = 0x01;
      
      if (unit == 'b') {
        for(i = 1; i < length; i++) {
          mask = ((mask << 1) | 0x01);
        }
      }
      structure.push({
        type   : match[1],
        length : length,
        unit   : unit,
        mask   : mask
      });
    }
    structure.lengthByte = lengthByte;
    return(structure);
  }
  
  function zipCodeToInteger(digit, a, b, c, d, e) {
    return(digit * 100000 + a * 10000 + b * 1000 + c * 100 * d * 10 * e);
  }
  
  function includeZipCode(zipCode, list) {
    for(var i = 0, l = list.length; i < l; i++) {
      var condition = list[i];
      if ((condition.from <= zipCode) && (zipCode <= condition.to)) return(true);
    }
    return(false);
  }


  var stringToNumber  = function(s) { return((s.toString() === '') ? 0 : parseInt(s, 10)); };
  
  var booleanToNumber = function(b) { return(b ? 1 : 0); };
  /**#@-*/
  
  function BinaryTableClass(table_ref, structure) {
    
    var uri = BML.Aux.combinePath(table_ref, location.href);
    var ajax = new BML.Ajax(uri, {
    overrideMimeType : 'text/plain; charset=x-user-defined',
    asynchronous     : false,
    method           : 'GET'
    });
    
    if (ajax.response.statusCode != 200) throw('[FileNotFound] :'+uri);

    
    var byteHandler = new ByteHandler(), i, l;
    var stream = ajax.response.responseBody;
    
    for(i = 0, l = stream.length/2; i < l; i++) {
      byteHandler.push(parseInt(stream.substring(i*2,i*2+2),16) & 0x00ff);
    }
    
    
    structure = parseStructure(structure);
    
    
    var table = [], entry;
    while(1) {
      if (!byteHandler.hasNextBit()) break;
      
      
      entry = [];
      for(i = 0, l = structure.length; i < l; i++) {
        var field = structure[i];
        
        switch(field.type) {
          case('B') : {
            // Boolean
            entry.push(new Boolean((byteHandler.getBits(1) > 0)));
          } break;
          case('U') : {
            // Unsigned Integer
            entry.push(new Number((field.unit == 'b') ?
                                  byteHandler.getBitsAsUnsignedInteger (field.length, field.mask) :
                                  byteHandler.getBytesAsUnsignedInteger(field.length)));
            } break;
          case('I') : {
            entry.push(new Number(byteHandler.getBytesAsInteger(field.length)));
          } break;
          case('S') : {
            if (field.unit == 'B') { 
              entry.push(String.charCodeFrom.apply(null,
                                                      byteHandler.getBytes(field.length)));
            } else { 
              length = byteHandler.getBytesAsUnsignedInteger(field.length);
              entry.push(String.charCodeFrom.apply(null,
                                                   byteHandler.getBytes(length)));
            }
          } break;
          case('P') : {
            (field.unit == 'b') ?
              byteHandler.getBitsAsUnsignedInteger (field.length, field.mask) :
              byteHandler.getBytesAsUnsignedInteger(field.length);
          } break;
          case('Z') : {
            length    = byteHandler.getBytesAsUnsignedInteger(field.length);
            var whole = { include : {}, exclude : {} };

            var includeListNum = byteHandler.getBytesAsUnsignedInteger(1) - 1;
            var excludeListNum = byteHandler.getBytesAsUnsignedInteger(1) / 4;
            includeListNum = includeListNum / 4 - excludeListNum;

            BML.Aux.each.call([[whole.exclude, excludeListNum],
                                [whole.include, includeListNum]], function(param) {
              var list = param[0], rangeFrom, msb, from, to, digits, flag, a, b, c, d, e;
              for(var i = 0, l = param[1];  i < l; i++) {
                msb = byteHandler.getBits(1);

                if (!msb) {
                  from = byteHandler.getBitsAsUnsignedInteger(7) * 10;
                  msb  = byteHandler.getBits(1);
                  to   = byteHandler.getBitsAsUnsignedInteger(7) * 10;
                  list.push({
                    from  : (from + 0) * 10000 +     0,
                    to    : (to   + 9) * 10000 +  9999
                  });
                  if (msb) {
                    from = byteHandler.getBitsAsUnsignedInteger(7) * 10;
                    msb  = byteHandler.getBits(1);
                    to   = byteHandler.getBitsAsUnsignedInteger(7) * 10;
                    list.push({
                      from  : (from + 0) * 10000 +     0,
                      to    : (to   + 9) * 10000 +  9999
                    });
                  } else {
                    byteHandler.getBytesAsInteger(2);
                  }

                } else {
                  digits = byteHandler.getBitsAsUnsignedInteger(7);
                  flag   = byteHandler.getBitsAsUnsignedInteger(4);
                  a      = byteHandler.getBitsAsUnsignedInteger(4);
                  b      = byteHandler.getBitsAsUnsignedInteger(4);
                  c      = byteHandler.getBitsAsUnsignedInteger(4);
                  d      = byteHandler.getBitsAsUnsignedInteger(4);
                  e      = byteHandler.getBitsAsUnsignedInteger(4);
                  
                  switch(flag) {
                    case(0x08) : {  // 3digit list
                      BML.Aux.each.call([a, b, c, d, e], function(num) {
                        if (num == 0x0f) return;
                        list.push({
                          from  : zipCodeToInteger(digits, num, 0, 0, 0, 0),
                          to    : zipCodeToInteger(digits, num, 9, 9, 9, 9)
                        });
                      });
                      rangeFrom = null;
                    } break;
                    case(0x09) : { // 3digit range
                      BML.Aux.each.call([[b, c], [d, e]], function(num) {
                        if ((num[0] == 0x0f) || (num[1] == 0x0f)) return;
                        list.push({
                          from  : zipCodeToInteger(digits, num[0], 0, 0, 0, 0),
                          to    : zipCodeToInteger(digits, num[1], 9, 9, 9, 9)
                        });
                      });
                      rangeFrom = null;
                    } break;
                    case(0x0a) : { // 5digit list
                      BML.Aux.each.call([[b, c], [d, e]], function(num) {
                        if ((num[0] == 0x0f) || (num[1] == 0x0f)) return;
                        list.push({
                          from  : zipCodeToInteger(digits, a, num[0], num[1], 0, 0),
                          to    : zipCodeToInteger(digits, a, num[0], num[1], 9, 9)
                        });
                      });
                      rangeFrom = null;
                    } break;
                    case(0x0b) : { // 5digit range from
                      rangeFrom = zipCodeToInteger(digits, a, b, c, 0, 0);
                    } break;
                    case(0x0c) : { // 5digit range to
                      if (!rangeFrom) throw('[InvalidFieldFormat] : 5 digit range from not defined');
                      list.push({
                        from  : rangeFrom,
                        to    : zipCodeToInteger(digits, a, b, c, 9, 9)
                      });
                      rangeFrom = null;
                    } break;
                    case(0x0d) : { // 7digit range from
                      rangeFrom = zipCodeToInteger(digits, a, b, c, d, e);
                    } break;
                    case(0x0e) : { // 7digit range to
                      if (!rangeFrom) throw('[InvalidFieldFormat] : 7 digit range from not defined');
                      list.push({
                        from  : rangeFrom,
                        to    : zipCodeToInteger(digits, a, b, c, d, e)
                      });
                      rangeFrom = null;
                    } break;
                    case(0x0f) : { // 7digit list
                      list.push({
                        from  : zipCodeToInteger(digits, a, b, c, d, e),
                        to    : zipCodeToInteger(digits, a, b, c, d, e)
                      });
                      rangeFrom = null;
                    } break;
                    default : { break; }
                  }
                }
              }
            });
            entry.push(whole);
          } break;
        default : { break; }
        }
      }
      table.push(entry);
    }
    var buf = []; // remove padding field
    for(i = 0, l = structure.length; i < l; i++) {
      entry = structure[i];
      if (entry.type != 'P') buf.push(entry);
    }
    this.structure = buf;
    this.table     = table;
    this.nrow      = table.length;
    this.ncolumn   = buf.length;
    
    return(this);
  }

  
  BinaryTableClass.prototype.close = function() {
    this.structure = null;
    this.table     = null;
    return(1);
  };
  
  BinaryTableClass.prototype.toString = function(row, column) {
    if (((row    < 0) || (this.nrow    <= row   )) ||
        ((column < 0) || (this.ncolumn <= column))) return(null);

    var value = this.table[row][column];
    switch(this.structure[column].type) {
      case('B') : return(value.toString());
      case('U') : return(value.toString());
      case('I') : return(value.toString());
//    case('S') : return(value);
      case('Z') : return(null);
      default   : return(value);
    }
    return(value);
  };
  
  BinaryTableClass.prototype.toNumber = function(row, column) {
    if (((row    < 0) || (this.nrow    <= row   )) ||
        ((column < 0) || (this.ncolumn <= column))) return(NaN);

    var value = this.table[row][column];
    switch(this.structure[column].type) {
      case('B') : return(booleanToNumber());
//    case('U') : return(value);
//    case('I') : return(value);
      case('S') : return(stringToNumber());
      case('Z') : return(NaN);
      default   : return(value);
    }
    return(value);
  };
  
  BinaryTableClass.prototype.toArray = function(startRow, numRow) {
    if (startRow < 0) return(null);

    var ret = [], structure = this.structure;
    var i = startRow, max = startRow + numRow, l = structure.length;
    while((i < this.nrow) && (i < max)) {
      var entry = [], row = this.table[i];
      for(var j = 0; j < l; j++) {
        entry.push((structure[j].type != 'Z') ? row[j] : null);
      }
      ret.push(entry);
      i++;
    }
    for(i = ret.length; i < numRow; i++) {
      ret.push(null); // padding
    }
    
    return(ret);
  };
  
  BinaryTableClass.prototype.search = function() {
    var args = arguments.slice(0);

    var startRow    = args.shift();
    var resultArray = args.pop();
    var limitCount  = args.pop();
    var logic       = args.pop();
    if (args.length % 3) throw('[InvalidArguments] : not enough arguments');

    var conditionList = [];
    for(var i = 0, l = args.length / 3; i < l; i++) {
      conditionList.push({
        searchedColumn : args[i * 3 + 0],
        compared       : args[i * 3 + 1],
        operator       : args[i * 3 + 2]
      });
    }

    for(i = startRow, l = this.nrow; i < l; i++) {
      if (limitCount <= 0) break;

      var row = this.table[i], flag = true;
      for(var j = 0, m = conditionList.length; j < m; j++) {
        var condition = conditionList[j];
        var value     = row[condition.searchedColumn];
        var compared  = condition.compared;

        switch(condition.operator) {
          // Unsigned Integer or Signed Integer
          case( 0) : { flag = value == compared; } break;
          case( 1) : { flag = value != compared; } break;
          case( 2) : { flag = value <  compared; } break;
          case( 3) : { flag = value <= compared; } break;
          case( 4) : { flag = value >  compared; } break;
          case( 5) : { flag = value >= compared; } break;
          case( 6) : { flag = value &  compared; } break;
          case( 7) : { flag = value |  compared; } break;
          case( 8) : { flag = value ^  compared; } break;
          case( 9) : { flag = value & ~compared; } break;
          case(10) : { flag = value | ~compared; } break;
          case(11) : { flag = value ^ ~compared; } break;
          // String
          case(32) : { flag = value == compared;             } break;
          case(33) : { flag = value.indexOf(compared) >=  0; } break;
          case(34) : { flag = value.indexOf(compared) === 0; } break;
          case(35) : { flag =
            value.lastIndexOf(compared) == value.length - compared.length; } break;
          case(36) : { flag = value != compared;             } break;
          case(37) : { flag = value.indexOf(compared) <   0; } break;
          // Boolean
          case(64) : { flag = value == compared; } break;
          case(65) : { flag = value != compared; } break;
          // ZipCode
          case(96) : { flag =  includeZipCode(compared, value.include) &&
                              !includeZipCode(compared, value.exclude); } break;
          case(97) : { flag = !includeZipCode(compared, value.include) &&
                               includeZipCode(compared, value.exclude); } break;
          default  : { flag = true; } break;
        }
//        if ((logic && flag) || (!logic && !flag)) break;
        if (logic == flag) break;
      }

      if (flag) resulutArray.push(row);
      limitCount--;
    }

    return((resultArray.length <=  0) ? NaN : (limitCount <= 0) ? --i : -1);
  };
  /**#@-*/
  return(BinaryTableClass);
})();

var iptv_uui = (function() {
  var SEERVICE_LOGO_URL_PREFIX  = 'images/dummy_logo/chLogo_';
  var SEERVICE_LOGO_URL_SUFFIX  = '.png';

  var FIND_EVENT_ID_URL_PREFIX  = 'http://localhost:8000/BML2XHTML/tsv/tsv_epg/epgfindEventId.';
  var FIND_EVENT_ID_URL_SUFFIX  = '.tsv';

  var GET_EVENT_INFO_URL_PREFIX = 'http://localhost:8000/BML2XHTML/tsv/tsv_epg/getIntEventInfo.';
  var GET_EVENT_INFO_URL_SUFFIX = '.tsv';
  
  var UUI_MEDIA_ERR_OK                =  0; 
  var UUI_MEDIA_ERR_NG                = -1; 
  var UUI_MEDIA_ERR_UNSUPPORTED       = -2; 
  var UUI_MEDIA_ERR_UNAVAILABLE       = -3; //
  var UUI_MEDIA_ERR_ENDOFDATA         = -4; //
  var UUI_MEDIA_ERR_INVALID_PARAMETER = -5; // 
  var UUI_MEDIA_ERR_NOT_READY         = -6; // 
  var UUI_MEDIA_ERR_INVALID_STATE     = -7; // 
  var UUI_MEDIA_ERR_FORBIDDEN         = -8; //
  var UUI_MEDIA_ERR_EXPIRED           = -9; //
  

/*  function onStateChangedEvt(){
    if(iptv_uui.onStateChanged) iptv_uui.onStateChanged(iptv_uui.Media2Status);
  }
  function onRateChangeToEvt(){
    if(iptv_uui.onRateChangeTo) iptv_uui.onRateChangeTo(iptv_uui.Media2GetRate(2),iptv_uui.Media2GetRate(1));
  }
  function onServiceChangedEvt(){
    if(iptv_uui.onServiceChanged) iptv_uui.onServiceChanged(iptv_uui.Media2iptvNetworkId,iptv_uui.Media2iptvServiceId);
  }
  function onCurrentEventIdEvt(){
    iptv_uui.EpgEpgGetCurEvtIdTimer=NaN;
    if(iptv_uui.onCurrentEventId) iptv_uui.onCurrentEventId(0,iptv_uui.EpgNetworkId,iptv_uui.EpgServiceId);
  }
  
  function Media2OpenPlayControl(url,position){
    var date = new Date();
    if(isNaN(position )) position=0;
    
    iptv_uui.Media2Status=3;
    iptv_uui.Media2Rate=0;
    iptv_uui.Media2Position=browser.addDate(date,(-1)*position,0);
    iptv_uui.Media2Duration=200000000;
    browser.setInterval("onStateChangedEvt();",100,1);
    return 0;
  }
  function Media2Start(){
    if(iptv_uui.Media2Status==3) {
      return;
    }
    else if(iptv_uui.Media2Status == 2) {
      if(iptv_uui.Media2Rate!=0) {
        iptv_uui.Media2Rate=0;
        browser.setInterval("onRateChangeToEvt();",100,1);
      }
      var date = new Date();
      var subdate = browser.subDate(date,iptv_uui.Media2PauseTime,0);
      iptv_uui.Media2Position = browser.addDate(iptv_uui.Media2Position,subdate,0);
    }
    iptv_uui.Media2Status=3;
    browser.setInterval("onStateChangedEvt();",100,1);
  }
  function Media2Pause(){
    if(iptv_uui.Media2Status==2) return;
    
    iptv_uui.Media2PauseTime = new Date();
    iptv_uui.Media2Status=2;
    browser.setInterval("onStateChangedEvt();",100,1);
  }
  function Media2Stop(){
    if(iptv_uui.Media2Status==5) return;
    iptv_uui.Media2Status=5;
    browser.setInterval("onStateChangedEvt();",100,1);
  }
  function Media2SetRate(isOffset,param){
    var oldparam = iptv_uui.Media2Rate;
    if(isNaN(isOffset) )return;
    if(isNaN(param) )return;
    if(isOffset == 0) {
      if(param == 100) iptv_uui.Media2Rate = 0;
      else reutrn;
    }
    else if(isOffset == 1) {
      if(param == 1) iptv_uui.Media2Rate++;
      if(param == -1) iptv_uui.Media2Rate--;
      if(iptv_uui.Media2Rate < -4) iptv_uui.Media2Rate = -4;
      if(iptv_uui.Media2Rate > 4) iptv_uui.Media2Rate = 4;
    }
    else return;
    if(iptv_uui.Media2Rate != oldparam) {
      browser.setInterval("onRateChangeToEvt();",100,1);
    }
    
  }
  function Media2GetRate(property){
    if(property == 1)
      return iptv_uui.Media2Rate;
    else if(property == 2){
      if(iptv_uui.Media2Rate >= 0)  return (iptv_uui.Media2Rate +1) *100;
      else return (iptv_uui.Media2Rate) *100;
    }
  }
  function Media2GetPosition(){
    if(! iptv_uui.Media2Position) return NaN;
    var time1 = new Date();
    
    if(iptv_uui.Media2Status==3)
      return browser.subDate(time1,iptv_uui.Media2Position,0);
    else if(iptv_uui.Media2Status==2){
      return browser.subDate(iptv_uui.Media2PauseTime,iptv_uui.Media2Position,0);
    }
  }
  function Media2GetDuration(){
    return iptv_uui.Media2Duration;
  }
  function Media2CheckService(type,network_id,service_id,skip_mode){
    return UUI_MEDIA_ERR_OK;
  }
  function Media2OpenService(type,network_id,service_id){
    
    iptv_uui.Media2iptvServiceId	= service_id;
    iptv_uui.Media2iptvNetworkId	= network_id;
    iptv_uui.Media2iptvType			= type;
    
    browser.setInterval("onServiceChangedEvt();",100,1);
  }

//    onServiceChanged
//      onAudioChanged
//        onCopyControlChanged
//          onCaptionChanged
//            onVideoChanged
//              onParentalChange

  function Media2GetServiceId(type,network_id,service_id,mode,property,skip_mode,service_order){
    if(isNaN(mode)) return;
    
    var targetNetworkId=NaN;
    var targetServiceId=NaN;
    
    //CH-
    if(mode == 0) {
      targetServiceId=service_id-1;
      targetNetworkId=network_id-1;
      if(targetServiceId<0) targetServiceId=0xffff;
      if(targetNetworkId<0) targetNetworkId=0xffff;
    }
    //CH+
    else if(mode == 1) {
      targetServiceId=service_id+1;
      targetNetworkId=network_id+1;
      if(targetServiceId>0xffff) targetServiceId=0;
      if(targetNetworkId>0xffff) targetNetworkId=0;
    }
  
    else if(mode == 2) {
    }
    
    else if(mode == 3) {
    }
  
    else if(mode == 4) {
    }

    else if(mode == 6) {
      if(iptv_uui.Media2iptvType != type) return UUI_MEDIA_ERR_UNAVAILABLE;
      targetServiceId=iptv_uui.Media2iptvServiceId;
      targetNetworkId=iptv_uui.Media2iptvNetworkId;
      
    }
    else return UUI_MEDIA_ERR_INVALID_PARAMETER;
    
    
    if(property == 0){
      if(!isNaN(targetNetworkId)) return targetNetworkId;
      else UUI_MEDIA_ERR_UNSUPPORTED;
    } else if(property == 1) {
      if(!isNaN(targetServiceId)) return targetServiceId;
      else UUI_MEDIA_ERR_UNSUPPORTED;
    } else {
      return UUI_MEDIA_ERR_INVALID_PARAMETER;
    }
    
    return UUI_MEDIA_ERR_NG;
  }

 */
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  var UIE_EPG_TYPE_IPTV = 0; // 
  var UIE_EPG_TYPE_TB   = 1; // 
  var UIE_EPG_TYPE_BS   = 2; //

  var UIE_EPG_PROPERTY_SERVICE_TYPE        = 0;
  var UIE_EPG_PROPERTY_CHANNEL_NUMBER      = 1;
  var UIE_EPG_PROPERTY_REMOTE_KEY_ID       = 2;
  var UIE_EPG_PROPERTY_SERVICE_LOGO_WIDTH  = 3;
  var UIE_EPG_PROPERTY_SERVICE_LOGO_HEIGHT = 4;
  var UIE_EPG_PROPERTY_FREE_CA_MODE        = 5;

  var UIE_EPG_PROPERTY_SERVICE_NAME        = 11;
  var UIE_EPG_PROPERTY_SERVICE_LOGO_URL    = 12;

  var EIT_START_TIME                       = 0; // 
  var EIT_DURATION                         = 1; // 
  var EIT_PARENTAL_RATING                  = 2; // 
  var EIT_DESCRIPTORS                      = 3; // 
  var EIT_CONTENT                          = 4; // 
  var EIT_GROUP_TYPE                       = 5; // 
  var EIT_GROUP_NETWORK_ID                 = 6; // 
  var EIT_GROUP_SERVICE_ID                 = 7; // 
  var EIT_GROUP_EVENT_ID                   = 8; // 
  var EIT_FREE_CA_MODE                     = 9; // 

  var EIT_SHORT_EVENT_NAME                 = 10; // 
  var EIT_SHORT_EVENT_TEXT                 = 11; // 
  var EIT_EXTENDED_EVENT                   = 12; // 
  
  var UIE_EPG_ERR_OK                       =  0; // 
  var UIE_EPG_ERR_NG                       = -1; //  
  var UIE_EPG_ERR_INVALID_NETWORK_ID       = -2; // 
  var UIE_EPG_ERR_INVALID_SERVICE_ID       = -3; // 
  var UIE_EPG_ERR_INVALID_EVENT_ID         = -4; // 
  var UIE_EPG_ERR_NOT_READY                = -5; // 
  var UIE_EPG_ERR_INVALID_PARAMETER        = -6; // 


  // int uie_EPG_select(int type, int network_id, int service_id , int *subErrNo)
  function EpgSelect(type, network_id, service_id) {
    iptv_uui.EpgServiceId = service_id;
    iptv_uui.EpgNetworkId = network_id;
    iptv_uui.EpgType      = type;
    return(UIE_EPG_ERR_OK);
  }

  var findEventIdCache = {};
  // int uie_EPG_findEventId(int start_time, int duration , int *subErrNo)
  function EpgFindEventId(start_time, duration) {
    var date = new Date; date.setTime(start_time * 1000);
    iptv_uui.objectCreateTime = date;

    var name = [iptv_uui.EpgType, iptv_uui.EpgNetworkId, iptv_uui.EpgServiceId].join('.') +
               FIND_EVENT_ID_URL_SUFFIX;
    var ret = findEventIdCache[name];
    if (typeof(ret) != 'undefined') return(ret);
    
    ret = browser.transmitTextDataOverIP(FIND_EVENT_ID_URL_PREFIX + name, null, 'EUC-JP');
    if (isNaN(ret[0]) || (ret[0] < 0)) return(UIE_EPG_ERR_NG);
    ret = parseInt((ret[2].split("\r\n"))[0], 10);
    findEventIdCache[name] = ret;

    return(ret);
  }

  //int uie_EPG_getNextEventId(int event_id , int *subErrNo)
  function EpgGetNextEventId(event_id) { return(event_id + 1); }

  var getEventInfoCache = {};
  // int uie_EPG_getIntEventInfo(int eit_type, int event_id, int description_type,
  //                             int param , int *subErrNo)
  function EpgGetIntEventInfo(eit_type, event_id, description_type, param) {
    if(isNaN(event_id) || (event_id < 0)) return(UIE_EPG_ERR_INVALID_EVENT_ID);
    if(isNaN(description_type))           return(UIE_EPG_ERR_NG);

    var name = [iptv_uui.EpgType, iptv_uui.EpgNetworkId, iptv_uui.EpgServiceId].join('.') +
               '_' + event_id + GET_EVENT_INFO_URL_SUFFIX;

    var target = getEventInfoCache[name];
    if (!target) {
      target = browser.transmitTextDataOverIP(GET_EVENT_INFO_URL_PREFIX + name, null, 'EUC-JP');
      if (isNaN(target[0]) || (target[0] < 0)) return(UIE_EPG_ERR_NG);
      target = ((target[2].split("\r\n"))[0]).split("\t");
      getEventInfoCache[name] = target;
    }

    var date = this.objectCreateTime;
    date = new Date(date.getFullYear(), date.getMonth(), date.getDate(),date.getHours(),0,0,0);

    if      (description_type == EIT_START_TIME)       { return(Math.floor(browser.addDate(date, parseInt(target[0],10), 1).getTime() / 1000));}
    else if (description_type == EIT_DURATION)         { return(parseInt(target[1],10)); }
    else if (description_type == EIT_PARENTAL_RATING)  { return(parseInt(target[2],10)); }
    else if (description_type == EIT_DESCRIPTORS)      { return(parseInt(target[3],10)); }
    else if (description_type == EIT_CONTENT)          { return(parseInt(target[4],10)); }
    else if (description_type == EIT_GROUP_TYPE)       { return(parseInt(target[5],10)); }
    else if (description_type == EIT_GROUP_NETWORK_ID) { return(parseInt(target[6],10)); }
    else if (description_type == EIT_GROUP_SERVICE_ID) { return(parseInt(target[7],10)); }
    else if (description_type == EIT_GROUP_EVENT_ID)   { return(parseInt(target[8],10)); }
    else if (description_type == EIT_FREE_CA_MODE)     { return(parseInt(target[9],10)); }
    else                                               { return(UIE_EPG_ERR_NG);         }
  }
  // int uie_EPG_getStringEventInfo(int eit_type, int event_id, int description_type,
  //                                int param, unsigned char resultStr[], int size , int *subErrNo)
  function EpgGetStringEventInfo(eit_type,event_id, description_type, param){
    var name = [iptv_uui.EpgType, iptv_uui.EpgNetworkId, iptv_uui.EpgServiceId].join('.') +
               '_' + event_id + GET_EVENT_INFO_URL_SUFFIX;
    var target = getEventInfoCache[name];
    if (!target) {
      target = browser.transmitTextDataOverIP(GET_EVENT_INFO_URL_PREFIX + name, null, 'EUC-JP');
      if (isNaN(target[0]) || (target[0] < 0)) return('');
      target = ((target[2].split("\r\n"))[0]).split("\t");
      getEventInfoCache[name] = target;
    }
    
    if      (description_type == EIT_SHORT_EVENT_NAME) { return(target[10]); }
    else if (description_type == EIT_SHORT_EVENT_TEXT) { return(target[11]); }
    else if (description_type == EIT_EXTENDED_EVENT)   { target = target[12 + param]; return(target ? target : ''); }
    else                                               { return('');         }
  }
  // int uie_EPG_getStringServiceInfo(int type, int network_id, int service_id,
  //                                  int property, unsigned char resultStr[],
  //                                  int size , int *subErrNo)
  function EpgGetStringServiceInfo(type, network_id, service_id, property) {
    if        (property == UIE_EPG_PROPERTY_SERVICE_NAME    ) {
      return(service_id);
    } else if (property == UIE_EPG_PROPERTY_SERVICE_LOGO_URL) {
      return(SEERVICE_LOGO_URL_PREFIX + service_id + SEERVICE_LOGO_URL_SUFFIX);
    }
  }
  // int uie_EPG_getIntServiceInfo(int type, int network_id, int service_id,
  //                               int property , int *subErrNo)
  function EpgGetIntServiceInfo(type, network_id, service_id, property) {
    if        (property == UIE_EPG_PROPERTY_SERVICE_TYPE       ) {
      return(type);
    } else if (property == UIE_EPG_PROPERTY_CHANNEL_NUMBER     ) {
      return(((type == UIE_EPG_TYPE_IPTV) || (type == UIE_EPG_TYPE_BS)) ?
             service_id : seervice_id); 
    } else if (property == UIE_EPG_PROPERTY_REMOTE_KEY_ID      ) {
      return(-1);
    } else if (property == UIE_EPG_PROPERTY_SERVICE_LOGO_WIDTH ) {
      return(120);
    } else if (property == UIE_EPG_PROPERTY_SERVICE_LOGO_HEIGHT) {
      return(90);
    } else if (property == UIE_EPG_PROPERTY_FREE_CA_MODE       ) {
      return(0);
    }
  }
//  function EpgGetCurrentEventId(){
//    if(! isNaN(iptv_uui.EpgEpgGetCurEvtIdTimer)) browser.clearTimer(iptv_uui.EpgEpgGetCurEvtIdTimer);
//    iptv_uui.EpgEpgGetCurEvtIdTimer = browser.setInterval("onCurrentEventIdEvt();",200,1);
//  }

  var UIE_RESERVE_ERR_OK                =  0; 
  var UIE_RESERVE_ERR_NG                = -1; 
  var UIE_RESERVE_ERR_ENDOFDATA         = -2; 
  var UIE_RESERVE_ERR_UNAVAILABLE       = -3; 
  var UIE_RESERVE_ERR_INVALID_PARAMETER = -4; 
  var UIE_RESERVE_ERR_NOTREADY          = -5; 
  var UIE_RESERVE_ERR_FULL              = -6; 
  
//  function ReserveGetCurrent(index){
//    return index;
//  }
//  function ReserveGetFindResult(index,property){
//    return "";
//  }
//  function ReserveGetStringFindResult(index,property){
//    return "";
//  }

  // int uie_Reserve_getReserveIdByEvent(int type, int network_id, int service_id, int event_id,
  //                                     char reserve_id[], void* reserve , int *subErrNo)
  function ReserveGetReserveIdByEvent(type, network_id, service_id, event_id, reserve) {
    return('');
  }

  
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  return({
    EpgServiceId        : NaN,
    EpgNetworkId        : NaN,
    EpgType             : NaN,
    
//    this.Media2OpenPlayControl	= Media2OpenPlayControl;
//    this.Media2Start			= Media2Start;
//    this.Media2Pause			= Media2Pause;
//    this.Media2Stop				= Media2Stop;
//    this.Media2SetRate			= Media2SetRate;
//    this.Media2GetRate			= Media2GetRate;
//    this.Media2GetPosition		= Media2GetPosition;
//    this.Media2GetDuration		= Media2GetDuration;
    
//    this.Media2CheckService		= Media2CheckService;
//    this.Media2OpenService		= Media2OpenService;
//    this.Media2GetServiceId		= Media2GetServiceId;
    
//    this.Media2Status			= 5;
//    this.Media2Rate				= NaN;
//    this.Media2Position			= NaN;
//    this.Media2Duration			= NaN;
//    this.Media2PauseTime		= NaN;
    
//    this.Media2iptvServiceId	= NaN;
//    this.Media2iptvNetworkId	= NaN;
//    this.Media2iptvType			= NaN;

//    EpgInit                 : EpgInit,
//    EpgExit                 : EpgExit,
    EpgSelect               : EpgSelect,
    EpgFindEventId          : EpgFindEventId,
    EpgGetNextEventId       : EpgGetNextEventId,
//    EpgGetPfEventId         : EpgGetPfEventId,
//    EpgGetCurrentEventId    : EpgGetCurrentEventId,
    EpgGetIntEventInfo      : EpgGetIntEventInfo,
    EpgGetStringEventInfo   : EpgGetStringEventInfo,
    EpgGetIntServiceInfo    : EpgGetIntServiceInfo,
    EpgGetStringServiceInfo : EpgGetStringServiceInfo,
//    EpgGetTime              : EpgGetTime,
//    this.EpgGetCurrentEventId	= EpgGetCurrentEventId;
    
    
//    this.EpgEpgGetCurEvtIdTimer = NaN;
    
//    this.ReserveGetCurrent		= ReserveGetCurrent;
//    this.ReserveGetFindResult	= ReserveGetFindResult;
//    this.ReserveGetStringFindResult	= ReserveGetStringFindResult;
    ReserveGetReserveIdByEvent : ReserveGetReserveIdByEvent,
    
//    this.onStateChanged			= null;
//    this.onRateChangeTo			= null;
//    this.onServiceChanged		= null;
    
      objectCreateTime : new Date()
  });
})();

var ps = BML.Aux.toPaddedString;

Date.prototype.toString = function() {
    return(this.getFullYear()         + '-' + 
           ps(this.getMonth()+1, '0') + '-' + 
           ps(this.getDate(),    '0') + 'T' + 
           ps(this.getHours(),   '0') + ':' + 
           ps(this.getMinutes(), '0') + ':' + 
           ps(this.getSeconds(), '0'));
  };
  
Date.prototype.toLocalString = Date.prototype.toString;
Date.prototype.toUTCString   = Date.prototype.toString;
BML.httpServerBaseUrl = "http://localhost:8000/cygwin/home/Kawamori/LIME-Book/lime/trans/bml.100915/bml_dnp/ehon_waoreon_test";
 BML.Dom.initialize();BML.CSS.initialize();

var PG=0;
var NX=0;
var PMX=20;
var NR="w";	// "f":¥Ñ¥Ñ,"w":¥Þ¥Þ,"c":¤¸¤Ö¤ó
var WR="";	// "w":¥ï¥ª,"r":¥ì¥ª¥ó
var PASS="";
var BTB=new Array();

var FID="";

var KNo;
var Key=0;
var CHG=1;

var RECORD=-1;
var TYPE=1;	// 0:¥Õ¥§¡¼¥É¥¤¥ó 1:¥«¥Ã¥È¥¤¥ó
var Sound=0;
var Interval=10000;
var Gyou=0;

var PosCnt=0;

var AutPlay=0;

var PSI=-1;
var FSI=-1;
var TSI=-1;
var MSI=-1;

var Myself=0;
var W_BTB=new Array();
var R_BTB=new Array();
function load(){
	var i;
	if(UR(1)=="EHON"){
		PG=NUM( UR(2) );
		NR=UR(3);
		WR=UR(4);
		AutPlay=1;
	}
	UW(3,NR);
	// ³¨ËÜ¥Ð¥¤¥Ê¥ê¼èÆÀ
	BTB=GBT("ehon.bin","0,U:1B,U:1B,U:1B,U:1B,U:1B");
	if(BTB!=null){
		PMX=BTB.length;
		if(1<=PG){
			for(i=0; i<BTB.length; i++){
				if(PG==BTB[i][0]){
					RECORD=i;
					Interval=BTB[i][3];
					Gyou=BTB[i][4];
					AutPlay=1;
					break;
				}
			}
		}
	}
	W_BTB=GBT("ehon_w_txt.bin","0,U:1B,U:1B,U:1B,U:1B,U:1B,U:1B,U:1B,U:1B");
	R_BTB=GBT("ehon_r_txt.bin","0,U:1B,U:1B,U:1B,U:1B,U:1B,U:1B,U:1B,U:1B");
	PGSET();
	UW(1,"");
	CHG=0;
//	if(NR=="c") LoopSTR();
//DEBUG("PSI="+PSI+"; FSI="+FSI+"; TSI="+TSI+"; MSI="+MSI+"; SSI="+SSI);
}
var LoopCnt=0;
function MLoop(){
//DEBUG4("Loop");
	STT(0);
//LoopCnt++;
//DEBUG("¥ë¡¼¥×"+LoopCnt);
	STT(1);
}
function LoopSTR(){
//DEBUG4("LSTR");
	MSI=bro.setInterval("MLoop();",36000,0);
}
function LoopSTP(){
//DEBUG4("LSTP");
	if(!isNaN(MSI) && 0<=MSI) bro.clearTimer(MSI);
	MSI=-1;
}
function PGSET(){
	if(Myself==1){
		LKS(1);
		WD("bl3",157);
		WD("rd3",159);
		WD("gr3",180);
		WD("yl3",170);
		WD("bl1",0);
		WD("rd1",0);
		WD("gr1",0);
		WD("yl1",0);
		LKS(0);
		LoopSTP();
		MLoop();
		LoopSTR();
	}
	else{
		LKS(1);
		if(0<=RECORD){
			WD("bl2",157);
			WD("rd2",159);
			WD("gr2",180);
			WD("yl2",170);
			WD("bl3",0);
			WD("rd3",0);
			WD("gr3",0);
			WD("yl3",0);
			WD("bl1",0);
			WD("rd1",0);
			WD("gr1",0);
			WD("yl1",0);
		}
		else{
			WD("bl1",157);
			WD("rd1",159);
			WD("gr1",180);
			WD("yl1",170);
			WD("bl3",0);
			WD("rd3",0);
			WD("gr3",0);
			WD("yl3",0);
			WD("bl2",0);
			WD("rd2",0);
			WD("gr2",0);
			WD("yl2",0);
			LoopSTP();
//DEBUG4(1);
			MLoop();
			LoopSTR();
		}
		LKS(0);
		HON();
	}
//	if(GET("bgm").streamStatus=="stop") STT(1);
//DEBUG("PSI="+PSI+"; FSI="+FSI+"; TSI="+TSI+"; MSI="+MSI+"; SSI="+SSI);
}
function HON(){
	var i,j,P,N,Pid,Pid2;
	if(0<=RECORD){
		if(NR!="c"){
			STT(0);
			// ²»À¼ÀÚ¤êÂØ¤¨
			if(0<=RECORD && NUM(BTB[RECORD][2]) ){
				LoopSTP();
//				DTC("bgm",NR+BTB[RECORD][0]+"_"+BTB[RECORD][2]+".aac");
				DTC("bgm",WR+NR+BTB[RECORD][0]+"_"+BTB[RECORD][2]+".aac");
//DEBUG3(WR+NR+BTB[RECORD][0]+"_"+BTB[RECORD][2]+".aac");
			}
			else{
				DTC("bgm","ehon.aac");
//DEBUG3("-");
			}
		}
TYPE=1;
		// ¥Õ¥§¡¼¥É¥¢¥¦¥È
		if(TYPE==0){
			CHG=1;
			WD("p"+(NX-1),812);
			PosCnt=0;
			FD_OUT();
			FSI=bro.setInterval("FD_OUT();",200,0);
		}
		// ¥«¥Ã¥È¥¢¥¦¥È
		else{
			LKS(1);
			if(0<PG) Pid="p"+(PG-1);
			else Pid="p0";
			WD(Pid,0);
			LF(Pid+"d",0);
//CD("debug4","");
			if(BTB!=null){
				if(0<=RECORD){
					for(j=1; j<=Gyou; j++){
//DEBUG4(Pid);
						WD(Pid+"_"+j,0);
					}
				}
				PG=BTB[RECORD][0];
				TYPE=BTB[RECORD][1];
				Interval=BTB[RECORD][3]*1000;
//DEBUG4(Interval);
				if(NR=="c") Interval=30000;
				Gyou=BTB[RECORD][4];
			}
			Pid="p"+(PG-1);
			WD(Pid,812);
//DEBUG("PG="+PG+"; TYPE="+TYPE+"; Interval="+Interval+"; Gyou="+Gyou);
			if(0<Gyou){
				if(NR!="c" && WR==""){
					if(UR(1)=="EHON") bro.setInterval("STR_TXT();",1000,1);
					else STR_TXT();
				}
				else{
//CD("debug4","");
					for(i=1; i<=Gyou; i++){
						Pid2=Pid;
						if(WR=="w" && W_BTB[(PG-1)][(i-1)]==1) Pid2=Pid+"w";
						else if(WR=="r" && R_BTB[(PG-1)][(i-1)]==1) Pid2=Pid+"r";
//DEBUG4(Pid2);
//						WD(Pid+"_"+i,334);
						WD(Pid2+"_"+i,334);
					}
				}
			}
			LKS(0);
			if(AutPlay){
				PSI=bro.setInterval("PG_CHG();",Interval,1);
			}
			CHG=0;
			if(NR!="c"){
				if( GET("bgm").data=="ehon.aac"){
					STT(1);
					LoopSTR();
				}
				else STT(1);
			}
//			else if(UR(1)=="EHON") STT(1);
		}
	}
	else{
		LKS(1);
		N=0;
		if(BTB!=null){
//CD("debug4","");
			for(i=0; i<PMX; i++){
				P=BTB[i][0];
				if(N==P) continue;
				Pid="p"+(P-1);
				WD(Pid,0);
				LF(Pid+"d",0);
				for(j=1; j<=BTB[i][4]; j++){
					Pid2=Pid;
					if(WR=="w" && W_BTB[(P-1)][(j-1)]==1) Pid2=Pid+"w";
					else if(WR=="r" && R_BTB[(P-1)][(j-1)]==1) Pid2=Pid+"r";
//DEBUG4("DEL:"+Pid2);
//					WD(Pid+"_"+j,0);
					WD(Pid2+"_"+j,0);
				}
			}
		}
		LKS(0);
		if(NR!="c"){
			STT(0);
			DTC("bgm","ehon.aac");
//DEBUG4(2);
			STT(1);
		}
		WD("p0",812);
	}
}
function PG_CHG(){
	if(Key){
		keyUp();
	}
	RECORD++;
	if(!isNaN(PSI) && 0<=PSI){
		bro.clearTimer(PSI);
		PSI=-1;
	}
	if(BTB!=null && PMX<=RECORD){
//DEBUG4("¤³¤³"+PMX+"; "+RECORD);
		return;
	}
	if(BTB!=null){
		if(0<=RECORD) NX=BTB[RECORD][0];
	}
	CHG=1;
	PGSET();
}
function FD_OUT(){
	PosCnt++;
	var i,j;
	var Pid="p"+(PG-1);
	if(PosCnt==10){
		if(!isNaN(FSI) && 0<=FSI){
			bro.clearTimer(FSI);
			FSI=-1;
		}
		PosCnt=0;
		LKS(1);
		if(0<PG){
			WD(Pid,0);
			LF(Pid+"d",0);
		}
		if(BTB!=null){
			if(0<PG){
				for(j=1; j<=Gyou; j++){
					WD(Pid+"_"+j,0);
				}
			}
			PG=BTB[RECORD][0];
			TYPE=BTB[RECORD][1];
			Interval=BTB[RECORD][3]*1000;
			if(NR=="c") Interval=30000;
			Gyou=BTB[RECORD][4];
		}
		if(0<Gyou){
			if(NR!="c"){
				if(UR(1)=="EHON") bro.setInterval("STR_TXT();",1000,1);
				else STR_TXT();
			}
			else{
				for(i=1; i<=Gyou; i++) WD(Pid+"_"+i,334);
			}
		}
		LKS(0);
		if(AutPlay){
			PSI=bro.setInterval("PG_CHG();",Interval,1);
		}
		CHG=0;
		if(NR!="c"){
			if( GET("bgm").data=="ehon.aac"){
				LoopSTR();
			}
			else STT(1);
		}
		else if(UR(1)=="EHON") STT(1);
	}
	else{
		var lpos=-81*PosCnt;
		LF(Pid+"d",lpos);
	}
}
var nowGyou=0;
var TxCnt=0;
var TxEnd=0;
function STR_TXT(){
	if(Gyou==0) return;
	nowGyou=1;
	TxCnt=0;
	var Tint=(Interval-2500)/Gyou;
	TxEnd=Tint/200;
	if(!isNaN(TSI) && 0<=TSI){
		bro.clearTimer(TSI);
		TSI=-1;
	}
	TSI=bro.setInterval("VIS_TXT();",200,0);
}
function VIS_TXT(){
	TxCnt++;
	var Pid="p"+(PG-1)+"_"+nowGyou;
//	if(TxCnt==5) WD(Pid,334);
	if(TxCnt==TxEnd){
		WD(Pid,334);
		if(Gyou==nowGyou){
			if(!isNaN(TSI) && 0<=TSI){
				bro.clearTimer(TSI);
				TSI=-1;
			}
			return;
		}
		nowGyou++;
		TxCnt=0;
	}
	else{
//		var W=334/TxEnd;
//		W=W*TxCnt;
//		WD(Pid,W);
	}
}
function BL(){
	if(FID=="") return;
//	VH(FID+"n",1);
//DEBUG2("BL");
	VH(FID+"d",0);
}
function DW(){
	if(FID=="") return;
//DEBUG2("DW");
	VH(FID+"d",1);
//	VH(FID+"n",0);
}
function keyDown(){
	if(CHG || Key) return;
	KNo=document.currentEvent.keyCode;
	if(!(KNo==19 || (21<=KNo && KNo<=24) )) return;
//DEBUG2("keyDown1");
	if( (21<=KNo && KNo<=24) || KNo==19){
//		if( (RECORD<0 && KNo!=23) || (0<=RECORD && NR!="c") ){
//			STT(0);
//			LoopSTP();
//			bro.playRomSound("romsound://7");
//		}

		if(0<=SSI){
			browser.clearTimer(SSI);
			SSI=-1;
		}
		LoopSTP();
		STT(0);
		PR(7);
	}
//DEBUG2("keyDown2");
	if(KNo==21){
		if(0<=RECORD) FID="bl2";
		else{
			if(Myself) FID="bl3";
//			else if(0<=RECORD) FID="bl2";
			else FID="bl1";
			DW();
		}
	}
	else if(KNo==22){
		if(0<=RECORD) FID="rd2";
		else{
			if(Myself) FID="rd3";
//			else if(0<=RECORD) FID="rd2";
			else FID="rd1";
			DW();
		}
	}
	else if(KNo==23){
		if(Myself) FID="gr3";
		else if(0<=RECORD) FID="gr2";
		else FID="gr1";
		DW();
	}
	else if(KNo==24){
		if(Myself) FID="yl3";
		else if(0<=RECORD) FID="yl2";
		else FID="yl1";
		DW();
	}
	else if(KNo==19){
		BL();
	}
	if(KNo!=23){
		if(!isNaN(PSI) && 0<=PSI){
			bro.clearTimer(PSI);
			PSI=-1;
		}
		if(!isNaN(TSI) && 0<=TSI){
			bro.clearTimer(TSI);
			TSI=-1;
		}
	}
//DEBUG2("keyDown3");
	Key=1;
}
function keyUp(){
	if(CHG || Key==0) return;
	if(!(KNo==19 || (21<=KNo && KNo<=24) )) return;
//DEBUG2("keyUp1");
	var i;
	if(KNo==19){
		if(0<=RECORD || Myself){
			RELOAD_PG();
		}
		else bro.launchDocument("../startup.bml","cut");
	}
//DEBUG2("keyUp2");
	var timing=0;
	if(KNo==21){
		if(Myself){
			Myself=0;
			RECORD=0;
			NR="f";
			WR="w";
			AutPlay=1;
			timing=1;
		}
		else if(0<=RECORD){
			if(PMX<=RECORD) RECORD-=2;
			else RECORD--;
//			if(21<=RECORD) RECORD=20;
		}
		else{
			RECORD=0;
			NR="f";
			WR="";
			AutPlay=1;
			timing=1;
		}
	}
	if(KNo==22){
		if(Myself){
			Myself=0;
			RECORD=0;
			NR="w";
			WR="r";
			AutPlay=1;
			timing=1;
		}
		else if(0<=RECORD){
			RECORD++;
			if(BTB.length<=RECORD) RECORD=-1;
		}
		else{
			RECORD=0;
			NR="w";
			WR="";
			AutPlay=1;
			timing=1;
		}
	}
	if(KNo==23){
		if(Myself){
			Myself=0;
			RECORD=0;
			AutPlay=1;
			timing=1;
		}
		else if(0<=RECORD){
			// ÌÜ¼¡¤Ø
			if(!isNaN(PSI) && 0<=PSI){
				bro.clearTimer(PSI);
				PSI=-1;
			}
			if(!isNaN(TSI) && 0<=TSI){
				bro.clearTimer(TSI);
				TSI=-1;
			}
			UW(3,NR);
			UW(4,WR);
			bro.launchDocument("mokuji.bml","cut");
		}
		else{
			Myself=1;
			NR="c";
			WR="";
		}
		BL();
	}
	if(KNo==24){
		if(0<=RECORD || Myself){
			// ºÇ½é¤Ø
			RELOAD_PG();
		}
		else{
			// ÌÜ¼¡¤Ø
//			UW(3,NR);
//			UW(4,WR);
//			bro.launchDocument("mokuji.bml","cut");
			bro.launchDocument("../startup.bml","cut");
		}
		BL();
	}
	if(BTB!=null){
		if(0<=RECORD) NX=BTB[RECORD][0];
	}
//DEBUG2("keyUp3");
	PGSET();
//DEBUG2("keyUp4");
	LKS(1);
	BL();
	if(FID!="") VH(FID+"d",0);
	LKS(0);
//DEBUG2("keyUp5");
	Key=0;
}
function RELOAD_PG(){
	// ºÇ½é¤Ø
//DEBUG4(RECORD+"; "+Gyou);
	var i;
	LKS(1);
	for(i=1; i<=Gyou; i++){
		WD("p"+RECORD+"_"+i,0);
	}
	LKS(0);
	RECORD=-1;
	AutPlay=0;
	Gyou=0;
	PG=1;
	Myself=0;
}
var doc=document;
var bro=browser;
function GET(id){ return doc.getElementById(id); }
function STY(id){ return GET(id).normalStyle; }
function CD(id,dat){ GET(id).firstChild.data=dat.toString(); }
function VH(id,v){ STY(id).visibility=(v==1)?"visible":"hidden"; }
function LF(id,l){ STY(id).left=l+"px"; }
function WD(id,w){ STY(id).width=w+"px"; }
function UR(n){ return bro.Ureg[n]; }
function UW(n,dat){ bro.Ureg[n]=dat.toString(); }
function PR(n){
//DEBUG2("romsound");
	bro.playRomSound("romsound://"+n);
}
var SSI=-1;
function STT(p){
	var dat=(p==1)?"play":"stop";
	if(p==1) SSI=browser.setInterval("STP();",1000,1);
	else{
		GET("bgm").streamStatus=(p==1)?"play":"stop";
//DEBUG2(GET("bgm").data+"; "+GET("bgm").streamStatus);
	}
}
function STP(){
//DEBUG4("¤³¤³");
	browser.clearTimer(SSI);
	SSI=-1;
	GET("bgm").streamStatus="play";
//DEBUG2(GET("bgm").data+"; "+GET("bgm").streamStatus);
}
function DTC(id,dat){ GET(id).data=dat.toString(); }
function NUM(dat){ return parseInt(dat,10); }
function LKS(l){
	if(l) bro.lockScreen();
	else bro.unlockScreen();
}
function GBT(file,str) {
	var bt=new Array();
	var t_b=new BinaryTable(file,str);
	if(t_b==null) return null;
	bt=t_b.toArray(0,t_b.nrow);
	t_b.close();
	return bt;
}
function DEBUG(dat){ CD("debug",dat); }
function DEBUG2(dat){ CD("debug2",dat); }
function DEBUG3(dat){ CD("debug3",dat); }
function DEBUG4(dat){
//	CD("debug4",GET("debug4").firstChild.data+dat+";\r\n");
	CD("debug4",GET("debug4").firstChild.data+dat+"; ");
}

</script></html>